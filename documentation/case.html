<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SY496B9L99"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-SY496B9L99');
</script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC: Case Files</title>
<meta name=”keywords” content="exascale, fluid dynamics, cfd, computational fluid dynamics, compressible, hpc, bryngelson, colonius, subgrid, multiphase, frontier, summit, el capitan, aurora, amd gpu, gpu, nvidia"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
// This file is set as MATHJAX_CODEFILE in the Doxyfile. It configures how
// MathJax renders expressions in Markdown so that it is consistent with GitHub.
MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath:  [ ['$',  '$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true,
      ignoreClass: "line" // Ignore code blocks: https://web.archive.org/web/20120430100225/http://www.mathjax.org/docs/1.1/options/tex2jax.html
    },
    "HTML-CSS": {
      fonts: ["TeX"]
    }
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="icon.ico" type="image/x-icon" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC
   </div>
   <div id="projectbrief">High-fidelity multiphase flow simulation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('case.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Case Files </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Case Files</h1>
<p>Example Python case files, also referred to as <em>input files</em>, can be found in the <a href="https://github.com/MFlowCode/MFC/tree/master/examples">examples/</a> directory. They print a Python dictionary containing input parameters for MFC. Their contents, and a guide to filling them out, are documented in the user manual. A commented, tutorial script can also be found in <a href="https://github.com/MFlowCode/MFC/blob/master/examples/3D_sphbubcollapse/case.py">examples/3d_sphbubcollapse/</a>.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Basic Skeleton</h2>
<p>The skeleton for an input file may look like the following:</p>
<div class="fragment"><div class="line"><span class="comment">#!/usr/bin/env python3</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> json</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Configuring case dictionary</span></div>
<div class="line">print(json.dumps({</div>
<div class="line">  <span class="comment"># Insert case parameters here</span></div>
<div class="line">  ...</div>
<div class="line">}))</div>
</div><!-- fragment --><p>Thus, you can run your case file with Python to view the computed case dictionary that will be processed by MFC when you run:</p>
<div class="fragment"><div class="line">python3 my_case_file.py</div>
</div><!-- fragment --><p>This is particularly useful when computations are done in Python to generate the case.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
(Optional) Accepting command line arguments</h2>
<p>Input files can accept command line arguments, forwarded by <span class="tt">mfc.sh run</span>. Consider this example from the <span class="tt">scaling</span> case:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> json, argparse</div>
<div class="line"> </div>
<div class="line">parser = argparse.ArgumentParser(</div>
<div class="line">    prog=<span class="stringliteral">&quot;scaling&quot;</span>,</div>
<div class="line">    description=<span class="stringliteral">&quot;Weak- and strong-scaling benchmark case.&quot;</span>,</div>
<div class="line">    formatter_class=argparse.ArgumentDefaultsHelpFormatter)</div>
<div class="line"> </div>
<div class="line">parser.add_argument(<span class="stringliteral">&quot;--mfc&quot;</span>, type=json.loads, default=<span class="stringliteral">&#39;{}&#39;</span>, metavar=<span class="stringliteral">&quot;DICT&quot;</span>,</div>
<div class="line">                    help=<span class="stringliteral">&quot;MFC&#39;s toolchain&#39;s internal state.&quot;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&quot;-s&quot;</span>, <span class="stringliteral">&quot;--scaling&quot;</span>, type=str, metavar=<span class="stringliteral">&quot;SCALING&quot;</span>, choices=[<span class="stringliteral">&quot;weak&quot;</span>, <span class="stringliteral">&quot;strong&quot;</span>],</div>
<div class="line">                    help=<span class="stringliteral">&quot;Whether weak- or strong-scaling is being exercised.&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Your parsed arguments are here</span></div>
<div class="line">args = parser.parse_args()</div>
</div><!-- fragment --><p>The <span class="tt">--mfc</span> argument is a JSON string representing <span class="tt">mfc.sh run</span>'s internal state, passed in when MFC runs your input file. It contains all the runtime information you might want from the build/run system. You can add as many additional arguments and options as you may need.</p>
<p>To run such a case, use the following format:</p>
<div class="fragment"><div class="line">./mfc.sh run &lt;path/to/case.py&gt; &lt;mfc.sh run arguments&gt; -- &lt;case arguments&gt;</div>
</div><!-- fragment --><p>For example, to run the <span class="tt">scaling</span> case in "weak-scaling" mode:</p>
<div class="fragment"><div class="line">./mfc.sh run examples/scaling/benchmark.py -t pre_process -j 8 -- --scaling weak</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Parameters</h2>
<h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Feature Compatibility</h2>
<p>Before diving into parameter details, check the <b><a class="el" href="case_constraints.html" title="Case Creator Guide">Feature Compatibility Guide</a></b> to understand:</p><ul>
<li>Which features work together (MHD, bubbles, phase change, etc.)</li>
<li>Common configuration patterns with copy-paste examples</li>
<li>Requirements for each model equation and Riemann solver</li>
</ul>
<p><b>Parameter Lookup:</b></p><ul>
<li>CLI search: <span class="tt">./mfc.sh params &lt;query&gt;</span> - Search ~3,300 parameters from the command line</li>
<li>Full reference: <b><a class="el" href="parameters.html" title="Case Parameters Reference">Case Parameters</a></b> - Complete parameter documentation</li>
</ul>
<p>There are multiple sets of parameters that must be specified in the python input file:</p><ol type="1">
<li><a class="el" href="#sec-runtime" title="1. Runtime">Runtime Parameters</a></li>
<li><a class="el" href="#sec-computational-domain" title="2. Computational Domain">Computational Domain Parameters</a></li>
<li><a class="el" href="#sec-patches" title="3. Patches">Patch Parameters</a></li>
<li><a class="el" href="#sec-immersed-boundary-patches" title="4. Immersed Boundary Patches">Immersed Boundary Patches</a></li>
<li><a class="el" href="#sec-fluid-materials" title="5. Fluid Material&#39;s">Fluid Material's Parameters</a></li>
<li><a class="el" href="#sec-simulation-algorithm" title="6. Simulation Algorithm">Simulation Algorithm Parameters</a></li>
<li><a class="el" href="#sec-formatted-output" title="7. Formatted Output">Formatted Database and Structure Parameters</a></li>
<li><a class="el" href="#sec-acoustic-source" title="8. Acoustic Source">(Optional) Acoustic Source Parameters</a></li>
<li><a class="el" href="#sec-bubble-models" title="9. Sub-grid Bubble Models">(Optional) Ensemble-Averaged Bubble Model Parameters</a></li>
<li><a class="el" href="#sec-velocity-field-setup" title="10. Velocity Field Setup">(Optional) Velocity Field Setup Parameters</a></li>
<li><a class="el" href="#sec-phase-change" title="11. Phase Change Model">(Optional) Phase Change Parameters</a></li>
<li><a class="el" href="#sec-artificial-mach-number" title="12. Artificial Mach Number">(Optional) Artificial Mach Number Parameters</a></li>
</ol>
<p>Items 8, 9, 10, 11 and 12 are optional sets of parameters that activate the acoustic source model, ensemble-averaged bubble model, initial velocity field setup, phase change, artificial Mach number respectively. Definition of the parameters is described in the following subsections.</p>
<h3 class="doxsection"><a class="anchor" id="sec-runtime"></a>
1. Runtime</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">run_time_info</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Output run-time information  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">rdma_mpi</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">(GPUs) Enable RDMA for MPI communication.  </td></tr>
</table>
<ul>
<li><span class="tt">run_time_info</span> generates a text file that includes run-time information including the CFL number(s) at each time-step.</li>
<li><span class="tt">rdma_mpi</span> optimizes data transfers between GPUs using Remote Direct Memory Access (RDMA). The underlying MPI implementation and communication infrastructure must support this feature, detecting GPU pointers and performing RDMA accordingly.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-computational-domain"></a>
2. Computational Domain</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">x[y,z]_domain%beg[end]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Beginning [ending] of the $x$[y,z]-direction domain  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">stretch_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Stretching of the mesh in the $x$[y,z]-direction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">a_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Rate at which the grid is stretched in the $x$[y,z]-direction  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">x[y,z]_a</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Beginning of the stretching in the negative $x$[y,z]-direction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">x[y,z]_b</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Beginning of the stretching in the positive $x$[y,z]-direction  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">loops_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of times to recursively apply grid stretching  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cyl_coord</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Cylindrical coordinates (2D: Axisymmetric, 3D: Cylindrical)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">m</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of grid cells in the $x$-coordinate direction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">n</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of grid cells in the $y$-coordinate direction  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">p</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of grid cells in the $z$-coordinate direction  </td></tr>
</table>
<p>The parameters define the boundaries of the spatial and temporal domains, and their discretization that are used in simulation.</p>
<ul>
<li><p class="startli"><span class="tt">[x,y,z]_domain%[beg,end]</span> define the spatial domain in $x$, $y$, and $z$ Cartesian coordinates:</p>
<p class="formulaDsp">
\[ x \in \left[ x\_domain\%beg, \; x\_domain\%end \right], \quad y \in \left[ y\_domain\%beg, \; y\_domain\%end \right], \quad z \in \left[ z\_domain\%beg, \; z\_domain\%end \right] \]
</p>
</li>
<li>$m$, $n$, and $p$ define the number of finite volume cells that uniformly discretize the domain along the $x$, $y$, and $z$ axes, respectively. Note that the actual number of cells in each coordinate axis is given as $[m,n,p]+1$. For example, $m=n=p=499$ discretizes the domain into $500^3$ cells. When the simulation is 2D/axi-symmetric or 1D, it requires that $p=0$ or $p=n=0$, respectively.</li>
<li><span class="tt">stretch_[x,y,z]</span> activates grid stretching in the $[x,y,z]$ directions. The grid is gradually stretched such that the domain boundaries are pushed away from the origin along a specified axis.</li>
<li><p class="startli"><span class="tt">a_[x,y,z]</span>, <span class="tt">[x,y,z]_a</span>, and <span class="tt">[x,y,z]_b</span> are parameters that define the grid stretching function. When grid stretching along the $x$ axis is considered, the stretching function is given as:</p>
<p class="formulaDsp">
\[ x_{cb,stretch} = x_{cb} + \frac{x_{cb}}{a_x} \Bigg[ \mathrm{log}\left[\mathrm{cosh} \left( \frac{a_x(x_{cb}-x_a)}{L} \right) \right] + \mathrm{log}\left[\mathrm{cosh} \left( \frac{a_x(x_{cb}-x_b)}{L} \right) \right] -2 \mathrm{log}\left[\mathrm{cosh} \left( \frac{a_x(x_b-x_a)}{2L} \right) \right]  \Bigg] \]
</p>
</li>
</ul>
<p>where <span class="tt">x_cb</span> and <span class="tt">x_[cb,stretch]</span> are the coordinates of a cell boundary at the original and stretched domains, respectively. <span class="tt">L</span> is the domain length along the <span class="tt">x</span> axis: <span class="tt">L</span>=<span class="tt">x_domain%end</span>-<span class="tt">x_domain%beg</span>. Crudely speaking, <span class="tt">x_a</span> and <span class="tt">x_b</span> define the coordinates at which the grid begins to get stretched in the negative and positive directions along the $x$ axis, respectively. $a_x$ defines the smoothness of the stretching. Stretching along the $y$ and $z$ axes follows the same logistics. Optimal choice of the parameters for grid stretching is case-dependent and left to the user. <span class="tt">loops_x[y,z]</span> defines the number of times the grid stretching function is applied and has a default value of one.</p>
<ul>
<li><span class="tt">cyl_coord</span> activates cylindrical coordinates. The domain is defined in $x$-$y$-$z$ cylindrical coordinates, instead of Cartesian coordinates. Domain discretization is accordingly conducted along the axes of cylindrical coordinates. When $p=0$, the domain is defined on $x$-$y$ axi-symmetric coordinates. In both Coordinates, mesh stretching can be defined along the $x$- and $y$-axes. MPI topology is automatically optimized to maximize the parallel efficiency for given choice of coordinate systems.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-patches"></a>
3. Patches</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadCenter">Analytical Definition  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">num_patches</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Number of initial condition geometric patches.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">num_fluids</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Number of fluids/components present in the flow.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">geometry</span> *  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Geometry configuration of the patch.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">alter_patch(i)</span> *  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Alter the $i$-th patch.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">x[y,z]_centroid</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Centroid of the applied geometry in the $[x,y,z]$-direction.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">length_x[y,z]</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Length, if applicable, in the $[x,y,z]$-direction.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">radius</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Radius, if applicable, of the applied geometry.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">smoothen</span> *  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Smoothen the applied patch.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">smooth_patch_id</span> *  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">A patch with which the applied patch is smoothened.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">smooth_coeff</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Smoothen coefficient.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">alpha(i)</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Supported  </td><td class="markdownTableBodyLeft">Volume fraction of fluid $i$.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">alpha_rho(i)</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Supported  </td><td class="markdownTableBodyLeft">Partial density of fluid $i$.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">pres</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Supported  </td><td class="markdownTableBodyLeft">Pressure.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">vel(i)</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Supported  </td><td class="markdownTableBodyLeft">Velocity in direction $i$.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">tau_e(i)</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Supported  </td><td class="markdownTableBodyLeft">Elastic stresses.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">hcid</span> *  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyLeft">Hard coded patch id  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cf_val</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Supported  </td><td class="markdownTableBodyLeft">Surface tension color function value  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_filepath</span>  </td><td class="markdownTableBodyCenter">String  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Path to an STL or OBJ file (not all OBJs are supported).  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">model_scale(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Model's (applied) scaling factor for component $i$.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_rotate(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Model's (applied) angle of rotation about axis $i$.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">model_translate(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Model's $i$-th component of (applied) translation.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_spc</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Number of samples per cell when discretizing the model into the grid.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">model_threshold</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyCenter">Not Supported  </td><td class="markdownTableBodyLeft">Ray fraction inside the model patch above which the fraction is set to one.  </td></tr>
</table>
<p>*: These parameters should be prepended with <span class="tt">patch_icpp(j)%</span> where $j$ is the patch index.</p>
<p>The Table lists the patch parameters. The parameters define the geometries and physical parameters of fluid components (patch) in the domain at initial condition. Note that the domain must be fully filled with patche(s). The code outputs error messages when an empty region is left in the domain.</p>
<ul>
<li><span class="tt">tau_e(i)</span> is the <span class="tt">i</span>-th component of the elastic stress tensor, ordered as <span class="tt">tau_xx</span>, <span class="tt">tau_xy</span>, <span class="tt">tau_yy</span>, <span class="tt">tau_xz</span>, <span class="tt">tau_yz</span>, and <span class="tt">tau_zz</span>. 1D simulation requires <span class="tt">tau(1)</span>, 2D <span class="tt">tau(1:3)</span>, and 3D <span class="tt">tau(1:6)</span>.</li>
</ul>
<h4 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Analytical Definition of Primitive Variables</h4>
<p>Some parameters, as described above, can be defined by analytical functions in the input file. For example, one can define the following patch:</p>
<div class="fragment"><div class="line">&#39;patch_icpp(2)%geometry&#39;    : 1,</div>
<div class="line">&#39;patch_icpp(2)%x_centroid&#39;  : 0.25,</div>
<div class="line">&#39;patch_icpp(2)%length_x&#39;    : 9.5,</div>
<div class="line">&#39;patch_icpp(2)%vel(1)&#39;      : 0.,</div>
<div class="line">&#39;patch_icpp(2)%pres&#39;        : 1.,</div>
<div class="line">&#39;patch_icpp(2)%alpha_rho(1)&#39;: &#39;1 + 0.1*sin(20*x*pi)&#39;,</div>
<div class="line">&#39;patch_icpp(2)%alpha(1)&#39;    : 1.,</div>
</div><!-- fragment --><p>where <span class="tt">alpha_rho</span> is defined with the <span class="tt">1 + 0.1*sin(20*x*pi)</span> function.</p>
<p>The expressions are interpreted as Fortran code, in the execution context and scope of the function that defines the patch. Additionally, the following variables are made available as shorthand:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Shorthand  </th><th class="markdownTableHeadNone">Expands To  </th><th class="markdownTableHeadNone">Shorthand  </th><th class="markdownTableHeadNone">Expands To  </th><th class="markdownTableHeadNone">Shorthand  </th><th class="markdownTableHeadNone">Expands To  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">x</span>  </td><td class="markdownTableBodyNone"><span class="tt">x_cc(i)</span>  </td><td class="markdownTableBodyNone"><span class="tt">lx</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">length_x</span>  </td><td class="markdownTableBodyNone"><span class="tt">xc</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">x_centroid</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">y</span>  </td><td class="markdownTableBodyNone"><span class="tt">y_cc(j)</span>  </td><td class="markdownTableBodyNone"><span class="tt">ly</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">length_y</span>  </td><td class="markdownTableBodyNone"><span class="tt">yc</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">y_centroid</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">z</span>  </td><td class="markdownTableBodyNone"><span class="tt">z_cc(k)</span>  </td><td class="markdownTableBodyNone"><span class="tt">lz</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">length_z</span>  </td><td class="markdownTableBodyNone"><span class="tt">zc</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">z_centroid</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">eps</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">epsilon</span>  </td><td class="markdownTableBodyNone"><span class="tt">beta</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">beta</span>  </td><td class="markdownTableBodyNone"><span class="tt">radii</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">radii</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">tau_e</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">tau_e</span>  </td><td class="markdownTableBodyNone"><span class="tt">r</span>  </td><td class="markdownTableBodyNone">The patch's <span class="tt">radius</span>  </td><td class="markdownTableBodyNone"><span class="tt">pi</span> and <span class="tt">e</span>  </td><td class="markdownTableBodyNone">\(\pi\) and \(e\)  </td></tr>
</table>
<p>where $(i,j,k)$ are the grid-indices of the current cell in each coordinate direction.</p>
<p>In the example above, the following code is generated:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (patch_id == 2) <span class="keywordflow">then</span></div>
<div class="line">    q_prim_vf(contxb)%sf(i, 0, 0) = 1 + 0.1*sin(20*x_cc(i)*3.141592653589793)</div>
<div class="line"><span class="keyword">end </span>if</div>
</div><!-- fragment --><h4 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Hard Coded Patches</h4>
<p>Some patch configurations are not adequately handled with the above analytic variable definitions. In this case, a hard coded patch can be used. Hard coded patches can be added by adding additional hard coded patch identifiers to <span class="tt">src/common/include/1[2,3]dHardcodedIC.fpp</span>. When using a hard coded patch, the <span class="tt">patch_icpp(patch_id)%hcid</span> must be set to the hard-coded patch id. For example, to add a 2D Hardcoded patch with an id of 200, one would add the following to <span class="tt">src/common/include/2dHardcodedIC.fpp</span></p>
<div class="fragment"><div class="line"><span class="comment">case(200)</span></div>
<div class="line">    ! primitive variables assignment</div>
</div><!-- fragment --><p>and use <span class="tt">patch_icpp(i)%hcid = 200</span> in the input file. Additional variables can be declared in <span class="tt">Hardcoded1[2,3]DVariables</span> and used in <span class="tt">hardcoded1[2,3]D</span>. As a convention, any hard coded patches that are part of the MFC master branch should be identified as 1[2,3]xx where the first digit indicates the number of dimensions.</p>
<p>The code provides three pre-built patches for dimensional extrusion of initial conditions:</p>
<ul>
<li><span class="tt">case(170)</span>: Load 1D profile from data files</li>
<li><span class="tt">case(270)</span>: Extrude 1D data to 2D domain</li>
<li><span class="tt">case(370)</span>: Extrude 2D data to 3D domain</li>
</ul>
<p>Setup: Only requires specifying <span class="tt">init_dir</span> and filename pattern via <span class="tt">zeros_default</span>. Grid dimensions are automatically detected from the data files. Implementation: All variables and file handling are managed in <span class="tt">src/common/include/ExtrusionHardcodedIC.fpp</span> with no manual grid configuration needed. Usage: Ideal for initializing simulations from lower-dimensional solutions, enabling users to add perturbations or modifications to the base extruded fields for flow instability studies.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Parameter Descriptions</h4>
<ul>
<li><span class="tt">num_patches</span> defines the total number of patches defined in the domain. The number has to be a positive integer.</li>
<li><span class="tt">num_fluids</span> defines the total number of fluids defined in each of the patches. The number has to be a positive integer.</li>
<li><span class="tt">patch_icpp(j)%geometry</span> defines the type of geometry of $j$-th patch by using an integer from 1 to 13. Definition of the patch type for each integer is listed in table <a class="el" href="#patch-types" title="Patch types">Patch Types</a>.</li>
<li><span class="tt">[x,y,z]_centroid</span>, <span class="tt">length_[x,y,z]</span>, and/or <span class="tt">radius</span> are used to uniquely define the geometry of the patch with given type. Requisite combinations of the parameters for each type can be found in is listed in table <a class="el" href="#patch-types" title="Patch types">Patch types</a>.</li>
<li><span class="tt">patch_icpp(j)%alter_patch(i)</span> activates alternation of <span class="tt">patch(i)</span> with <span class="tt">patch(j)</span>. For instance, in a 2D simulation, when a cylindrical <span class="tt">patch(2)</span> is immersed in a rectangular <span class="tt">patch(1)</span>:<ul>
<li><span class="tt">patch_icpp(1)%geometry = 3</span></li>
<li><span class="tt">patch_icpp(2)%geometry = 2</span></li>
<li><span class="tt">patch_icpp(2)%alter_patch(1) = 'T'</span></li>
</ul>
</li>
<li><span class="tt">smoothen</span> activates smoothening of the boundary of the patch that alters the existing patch. When smoothening occurs, fluids of the two patches are mixed in the region of the boundary. For instance, in the aforementioned case of the cylindrical patch immersed in the rectangular patch, smoothening occurs when <span class="tt">patch_icpp(2)%smoothen = 'T'</span>. <span class="tt">smooth_coeff</span> controls the thickness of the region of smoothening (sharpness of the mixture region). The default value of <span class="tt">smooth_coeff</span> is unity. The region of smoothening is thickened with decreasing the value. Optimal choice of the value of <span class="tt">smooth_coeff</span> is case-dependent and left to the user.</li>
<li><span class="tt">patch_icpp(j)%alpha(i)</span>, <span class="tt">patch_icpp(j)%alpha_rho(i)</span>, <span class="tt">patch_icpp(j)%pres</span>, and <span class="tt">patch_icpp(j)%vel(i)</span> define for $j$-th patch the void fraction of <span class="tt">fluid(i)</span>, partial density of <span class="tt">fluid(i)</span>, the pressure, and the velocity in the $i$-th coordinate direction. These physical parameters must be consistent with fluid material's parameters defined in the next subsection.</li>
<li><span class="tt">model_filepath</span> defines the root directory of the STL or OBJ model file.</li>
<li><span class="tt">model_scale</span>, <span class="tt">model_rotate</span> and <span class="tt">model_translate</span> define how the model should be transformed to domain-space by first scaling by <span class="tt">model_scale</span>, then rotating about the Z, X, and Y axes (using <span class="tt">model_rotate</span>), and finally translating by <span class="tt">model_translate</span>.</li>
<li><span class="tt">model_spc</span> and <span class="tt">model_threshold</span> are ray-tracing parameters. <span class="tt">model_spc</span> defines the number of rays per cell to render the model. <span class="tt">model_threshold</span> defines the ray-tracing threshold at which the cell is marked as the model.</li>
</ul>
<h4 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
Elliptic Smoothing</h4>
<p>Initial conditions in which not all patches support the <span class="tt">patch_icpp(j)%smoothen</span> parameter can still be smoothed by applying iterations of the heat equation to the initial condition. This is enabled by adding <span class="tt">'elliptic_smoothing': "T",</span> and <span class="tt">'elliptic_smoothing_iters': N,</span> to the case dictionary, where <span class="tt">N</span> is the number of smoothing iterations to apply.</p>
<h3 class="doxsection"><a class="anchor" id="sec-immersed-boundary-patches"></a>
4. Immersed Boundary Patches</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">geometry</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Geometry configuration of the patch.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">x[y,z]_centroid</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Centroid of the applied geometry in the [x,y,z]-direction.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">length_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Length, if applicable, in the [x,y,z]-direction.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">radius</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Radius, if applicable, of the applied geometry.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">theta</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Angle of attach applied to airfoil IB patches  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">c</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">NACA airfoil parameters (see below)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">t</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">NACA airfoil parameters (see below)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">m</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">NACA airfoil parameters (see below)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">p</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">NACA airfoil parameters (see below)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">slip</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Apply a slip boundary  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">model_filepath</span>  </td><td class="markdownTableBodyCenter">String  </td><td class="markdownTableBodyLeft">Path to an STL or OBJ file (not all OBJs are supported).  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_scale(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Model's (applied) scaling factor for component $i$.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">model_rotate(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Model's (applied) angle of rotation about axis $i$.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_translate(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Model's $i$-th component of (applied) translation.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">model_spc</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of samples per cell when discretizing the model into the grid.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_threshold</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Ray fraction inside the model patch above which the fraction is set to one.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">moving_ibm</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Sets the method used for IB movement.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">vel(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Initial velocity of the moving IB in the i-th direction.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">angular_vel(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Initial angular velocity of the moving IB in the i-th direction.  </td></tr>
</table>
<p>These parameters should be prepended with <span class="tt">patch_ib(j)%</span> where $j$ is the patch index.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Parameter Descriptions</h4>
<ul>
<li><span class="tt">geometry</span> defines the type of geometry of an immersed boundary patch with an integer number. Definitions for currently implemented immersed boundary patch types are listed in table <a class="el" href="#immersed-boundary-patch-types" title="Immersed Boundary Patch Types">Immersed Boundary Patch Type</a>.</li>
<li><span class="tt">x[y,z]_centroid</span> is the centroid location of the patch in the x[y,z]-direction</li>
<li><span class="tt">length_x[y,z]</span> is the length of the patch in the x[y,z]-direction.</li>
<li><span class="tt">radius</span> is the radius to be used for circular patches.</li>
<li><span class="tt">theta</span> allows for the angle of attach of airfoil patches to be changed.</li>
<li><span class="tt">c</span>, <span class="tt">t</span>, <span class="tt">p</span>, and <span class="tt">m</span> specify the parameters for a NACA airfoil. <span class="tt">m</span> is the maximum camber, <span class="tt">p</span> is the location of maximum camber, <span class="tt">c</span> is the coord length, and <span class="tt">t</span> is the thickness. Additional details on this specification can be found in <a href="https://web.stanford.edu/~cantwell/AA200_Course_Material/The%20NACA%20airfoil%20series.pdf">The Naca Airfoil Series</a></li>
<li><span class="tt">slip</span> applies a slip boundary to the surface of the patch if true and a no-slip boundary condition to the surface if false.</li>
<li>Please see <a class="el" href="#sec-patches" title="3. Patches">Patch Parameters</a> for the descriptions of <span class="tt">model_filepath</span>, <span class="tt">model_scale</span>, <span class="tt">model_rotate</span>, <span class="tt">model_translate</span>, <span class="tt">model_spc</span>, and <span class="tt">model_threshold</span>.</li>
<li><span class="tt">moving_ibm</span> sets the method by which movement will be applied to the immersed boundary. Using 0 will result in no movement. Using 1 will result 1-way coupling where the boundary moves at a constant rate and applied forces to the fluid based upon it's own motion. In 1-way coupling, the fluid does not apply forces back onto the IB.</li>
<li><span class="tt">vel(i)</span> is the initial linear velocity of the IB in the x, y, z direction for i=1, 2, 3. When <span class="tt">moving_ibm</span> equals 1, this velocity is constant.</li>
<li><span class="tt">angular_vel(i)</span> is the initial angular velocity of the IB about the x, y, z axes for i=1, 2, 3 in radians per second. When <span class="tt">moving_ibm</span> equals 1, this angular velocity is constant.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-fluid-materials"></a>
5. Fluid Material's</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">gamma</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Stiffened-gas parameter \(\Gamma\) of fluid.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">pi_inf</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Stiffened-gas parameter \(\Pi_\infty\) of fluid.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">Re(1)</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Shear viscosity of fluid.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">Re(2)</span> *  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Volume viscosity of fluid.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cv</span> **  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Sffened-gas parameter $c_v$ of fluid.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">qv</span> **  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Stiffened-gas parameter $q$ of fluid.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">qvp</span> **  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Stiffened-gas parameter $q'$ of fluid.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">sigma</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Surface tension coefficient  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">G</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Shear modulus of solid.  </td></tr>
</table>
<p>Fluid material's parameters. All parameters except for sigma should be prepended with <span class="tt">fluid_pp(i)</span> where $i$ is the fluid index.</p>
<p>*: Parameters that work only with <span class="tt">model_eqns = 2</span>.</p>
<p>**: Parameters that work only with <span class="tt">model_eqns = 3</span>.</p>
<p>The table lists the fluid material's parameters. The parameters define material's property of compressible fluids that are used in simulation.</p>
<ul>
<li><span class="tt">fluid_pp(i)%gamma</span> and <span class="tt">fluid_pp(i)%pi_inf</span> define \(\Gamma\) and \(\Pi\) as parameters of $i$-th fluid that are used in stiffened gas equation of state.</li>
<li><span class="tt">fluid_pp(i)%Re(1)</span> and <span class="tt">fluid_pp(i)%Re(2)</span> define the shear and volume viscosities of $i$-th fluid, respectively.</li>
</ul>
<p>When these parameters are undefined, fluids are treated as inviscid. Details of implementation of viscosity in MFC can be found in Coralic <a class="el" href="citelist.html#CITEREF_coralic15">[14]</a>.</p>
<ul>
<li><span class="tt">fluid_pp(i)%cv</span>, <span class="tt">fluid_pp(i)%qv</span>, and <span class="tt">fluid_pp(i)%qvp</span> define $c_v$, $q$, and $q'$ as parameters of $i$-th fluid that are used in stiffened gas equation of state.</li>
<li><span class="tt">fluid_pp(i)%G</span> is required for <span class="tt">hypoelasticity</span>.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-simulation-algorithm"></a>
6. Simulation Algorithm</h3>
<p>See <a class="el" href="equations.html" title="Equations">Equations</a> for the mathematical models these parameters control.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%beg[end]</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Beginning [ending] boundary condition in the $[x,y,z]$-direction (negative integer, see table <a class="el" href="#boundary-conditions" title="Boundary conditions">Boundary Conditions</a>)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%vb[1,2,3]</span>‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Velocity in the (x,1), (y, 2), (z,3) direction applied to <span class="tt">bc_[x,y,z]%beg</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%ve[1,2,3]</span>‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Velocity in the (x,1), (y, 2), (z,3) direction applied to <span class="tt">bc_[x,y,z]%end</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">model_eqns</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Multicomponent model: [1] \(\Gamma/\Pi_\infty\); [2] 5-equation; [3] 6-equation; [4] 4-equation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">alt_soundspeed</span> *  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Alternate sound speed and \(K \nabla \cdot u\) for 5-equation model  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">adv_n</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Solving directly for the number density (in the method of classes) and compute void fraction from the number density  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">mpp_lim</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Mixture physical parameters limits  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">mixture_err</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Mixture properties correction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">time_stepper</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Runge&ndash;Kutta order [1-3]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">adap_dt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Strang splitting scheme with adaptive time stepping  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">recon_type</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Reconstruction Type: [1] WENO; [2] MUSCL  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">adap_dt_tol</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Tolerance for adaptive time stepping in Strang splitting scheme  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">adap_dt_max_iters</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Max iteration for adaptive time stepping in Strang splitting scheme  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">weno_order</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">WENO order [1,3,5]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">weno_eps</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">WENO perturbation (avoid division by zero)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">mapped_weno</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">WENO-M (WENO with mapping of nonlinear weights)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">wenoz</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">WENO-Z  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">wenoz_q</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">WENO-Z power parameter q (only for WENO7)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">teno</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">TENO (Targeted ENO)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">teno_CT</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">TENO threshold for smoothness detection  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">null_weights</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Null WENO weights at boundaries  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">mp_weno</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Monotonicity preserving WENO  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">muscl_order</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">MUSCL order [1,2]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">muscl_lim</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">MUSCL Slope Limiter: [1] minmod; [2] monotonized central; [3] Van Albada; [4] Van Leer; [5] SUPERBEE  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">int_comp</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">THINC Interface Compression  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">ic_eps</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Interface compression threshold (default: 1e-4)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">ic_beta</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Interface compression sharpness parameter (default: 1.6)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">riemann_solver</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Riemann solver algorithm: [1] HLL*; [2] HLLC; [3] Exact*; [4] HLLD (only for MHD)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">low_Mach</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Low Mach number correction for HLLC Riemann solver: [0] None; [1] Pressure (Chen et al. <a class="el" href="citelist.html#CITEREF_chen22">[11]</a>); [2] Velocity (Thornber et al. <a class="el" href="citelist.html#CITEREF_thornber08">[49]</a>)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">avg_state</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Averaged state evaluation method: [1] Roe average*; [2] Arithmetic mean  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">wave_speeds</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Wave-speed estimation: [1] Direct (Batten et al. <a class="el" href="citelist.html#CITEREF_batten97">[5]</a>); [2] Pressure-velocity* (Toro <a class="el" href="citelist.html#CITEREF_toro09">[51]</a>)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">weno_Re_flux</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Compute velocity gradient using scalar divergence theorem  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">weno_avg</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Arithmetic mean of left and right, WENO-reconstructed, cell-boundary values  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">dt</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Time step size  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">t_step_start</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Simulation starting time step  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">t_step_stop</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Simulation stopping time step  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">t_step_save</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Frequency to output data  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">t_step_print</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Frequency to print the current step number to standard output (default 1)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cfl_adap_dt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">CFL based adaptive time-stepping  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">cfl_const_dt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">CFL based non-adaptive time-stepping  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cfl_target</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Specified CFL value  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">n_start</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Save file from which to start simulation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">t_save</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Time duration between data output  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">t_stop</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Simulation stop time  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">surface_tension</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Activate surface tension  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">viscous</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Activate viscosity  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">hypoelasticity</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Activate hypoelasticity*  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">igr</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable solution via information geometric regularization (IGR) Cao and Schafer <a class="el" href="citelist.html#CITEREF_cao24">[9]</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">igr_order</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Order of reconstruction for IGR [3,5]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">alf_factor</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Alpha factor for IGR entropic pressure (default 10)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">igr_pres_lim</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Limit IGR pressure to avoid negative values (default F)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">igr_iter_solver</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Solution method for IGR elliptic solve [1] Jacobi [2] Gauss-Seidel  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">num_igr_iters</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of iterations for for the IGR elliptic solve (default 2)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">num_igr_warm_start_iters</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of iterations for the IGR elliptic solve at the first time step (default 50)  </td></tr>
</table>
<ul>
<li>* Options that work only with <span class="tt">model_eqns = 2</span>.</li>
<li>† Options that work only with <span class="tt">cyl_coord = 'F'</span>.</li>
<li>‡ Options that work only with <span class="tt">bc_[x,y,z]%[beg,end] = -15</span> and/or <span class="tt">bc_[x,y,z]%[beg,end] = -16</span>.</li>
</ul>
<p>The table lists simulation algorithm parameters. The parameters are used to specify options in algorithms that are used to integrate the governing equations of the multi-component flow based on the initial condition. Models and assumptions that are used to formulate and discretize the governing equations are described in Wilfong et al. <a class="el" href="citelist.html#CITEREF_wilfong26">[54]</a> and Bryngelson et al. <a class="el" href="citelist.html#CITEREF_bryngelson21">[8]</a>. Details of the simulation algorithms and implementation of the WENO scheme can be found in Coralic <a class="el" href="citelist.html#CITEREF_coralic15">[14]</a>.</p>
<ul>
<li><span class="tt">bc_[x,y,z]%[beg,end]</span> specifies the boundary conditions at the beginning and the end of domain boundaries in each coordinate direction by a negative integer from -1 through -16. See table <a class="el" href="#boundary-conditions" title="Boundary conditions">Boundary Conditions</a> for details. Boundary condition patches can be used with non-characteristic boundary conditions. Their use is detailed in <a class="el" href="#boundary-condition-patches" title="Boundary Condition Patches">Boundary Condition Patches</a>.</li>
<li><span class="tt">bc_[x,y,z]%vb[1,2,3]</span> specifies the velocity in the (x,1), (y,2), (z,3) direction applied to <span class="tt">bc_[x,y,z]%beg</span> when using <span class="tt">bc_[x,y,z]%beg = -16</span>. Tangential velocities require viscosity, <span class="tt">weno_avg = T</span>, and <span class="tt">bc_[x,y,z]%beg = -16</span> to work properly. Normal velocities require <span class="tt">bc_[x,y,z]%end = -15</span> or <span class="tt">bc_[x,y,z]%end = -16</span> to work properly.</li>
<li><span class="tt">bc_[x,y,z]%ve[1,2,3]</span> specifies the velocity in the (x,1), (y,2), (z,3) direction applied to <span class="tt">bc_[x,y,z]%beg</span> when using <span class="tt">bc_[x,y,z]%end = -16</span>. Tangential velocities require viscosity, <span class="tt">weno_avg = T</span>, and <span class="tt">bc_[x,y,z]%end = 16</span> to work properly. Normal velocities require <span class="tt">bc_[x,y,z]%end = -15</span> or <span class="tt">bc_[x,y,z]%end = -16</span> to work properly.</li>
<li><span class="tt">model_eqns</span> specifies the choice of the multi-component model that is used to formulate the dynamics of the flow using integers from 1 through 3. <span class="tt">model_eqns = 1</span>, <span class="tt">2</span>, and <span class="tt">3</span> correspond to \(\Gamma\)- \(\Pi_\infty\) model (Johnsen <a class="el" href="citelist.html#CITEREF_johnsen08">[23]</a>), 5-equation model (Allaire et al. <a class="el" href="citelist.html#CITEREF_allaire02">[1]</a>), and 6-equation model (Saurel et al. <a class="el" href="citelist.html#CITEREF_saurel09">[41]</a>), respectively. The difference of the two models is assessed by (Schmidmayer et al. <a class="el" href="citelist.html#CITEREF_schmidmayer20">[43]</a>). Note that some code parameters are only compatible with 5-equation model.</li>
<li><span class="tt">alt_soundspeed</span> activates the source term in the advection equations for the volume fractions, \(K\nabla\cdot \underline{u}\), that regularizes the speed of sound in the mixture region when the 5-equation model is used. The effect and use of the source term are assessed by Schmidmayer et al. <a class="el" href="citelist.html#CITEREF_schmidmayer20">[43]</a>.</li>
<li><span class="tt">adv_n</span> activates the direct computation of number density by the Riemann solver instead of computing number density from the void fraction in the method of classes.</li>
<li><span class="tt">mpp_lim</span> activates correction of solutions to avoid a negative void fraction of each component in each grid cell, such that \(\alpha_i&gt;\varepsilon\) is satisfied at each time step.</li>
<li><span class="tt">mixture_err</span> activates correction of solutions to avoid imaginary speed of sound at each grid cell.</li>
<li><span class="tt">time_stepper</span> specifies the order of the Runge-Kutta (RK) time integration scheme that is used for temporal integration in simulation, from the 1st to 5th order by corresponding integer. Note that <span class="tt">time_stepper = 3</span> specifies the total variation diminishing (TVD), third order RK scheme (Gottlieb and Shu <a class="el" href="citelist.html#CITEREF_gottlieb98">[18]</a>).</li>
<li><span class="tt">adap_dt</span> activates the Strang operator splitting scheme which splits flux and source terms in time marching, and an adaptive time stepping strategy is implemented for the source term. It requires <span class="tt">bubbles_euler = 'T'</span>, <span class="tt">polytropic = 'T'</span>, <span class="tt">adv_n = 'T'</span> and <span class="tt">time_stepper = 3</span>. Additionally, it can be used with <span class="tt">bubbles_lagrange = 'T'</span> and <span class="tt">time_stepper = 3</span>. <span class="tt">adap_dt_tol</span> and <span class="tt">adap_dt_max_iters</span> are 1e-4 and 100, respectively, by default.</li>
<li><span class="tt">weno_order</span> specifies the order of WENO scheme that is used for spatial reconstruction of variables by an integer of 1, 3, 5, and 7, that correspond to the 1st, 3rd, 5th, and 7th order, respectively.</li>
<li><span class="tt">weno_eps</span> specifies the lower bound of the WENO nonlinear weights. It is recommended to set <span class="tt">weno_eps</span> to $10^{-6}$ for WENO-JS, and to $10^{-40}$ for other WENO variants.</li>
<li><span class="tt">mapped_weno</span> activates the WENO-M scheme in place of the default WENO-JS scheme (Henrick et al. <a class="el" href="citelist.html#CITEREF_henrick05">[21]</a>). WENO-M a variant of the WENO scheme that remaps the nonlinear WENO-JS weights by assigning larger weights to non-smooth stencils, reducing dissipation compared to the default WENO-JS scheme, at the expense of higher computational cost. Only one of <span class="tt">mapped_weno</span>, <span class="tt">wenoz</span>, and <span class="tt">teno</span> can be activated.</li>
<li><span class="tt">wenoz</span> activates the WENO-Z scheme in place of the default WENO-JS scheme (Borges et al. <a class="el" href="citelist.html#CITEREF_borges08">[6]</a>). WENO-Z is a variant of the WENO scheme that further reduces the dissipation compared to the WENO-M scheme. It has similar computational cost to the WENO-JS scheme.</li>
<li><span class="tt">wenoz_q</span> specifies the power parameter <span class="tt">q</span> used in the WENO-Z scheme. It controls how aggressively the smoothness coefficients scale the weights. A higher value of <span class="tt">wenoz_q</span> increases the sensitivity to smoothness, improving stability but worsening numerical dissipation. For WENO3 and WENO5, <span class="tt">q=1</span> is fixed, so <span class="tt">wenoz_q</span> must not be set. For WENO7, <span class="tt">wenoz_q</span> can be set to 2, 3, or 4.</li>
<li><span class="tt">teno</span> activates the TENO scheme in place of the default WENO-JS scheme (Fu et al. <a class="el" href="citelist.html#CITEREF_fu16">[16]</a>). TENO is a variant of the ENO scheme that is the least dissipative, but could be less robust for extreme cases. It uses a threshold to identify smooth and non-smooth stencils, and applies optimal weights to the smooth stencils. Only available for <span class="tt">weno_order = 5</span> and <span class="tt">7</span>. Requires <span class="tt">teno_CT</span> to be set. Does not support grid stretching.</li>
<li><span class="tt">teno_CT</span> specifies the threshold for the TENO scheme. This dimensionless constant, also known as $C_T$, sets a threshold to identify smooth and non-smooth stencils. Larger values make the scheme more robust but also more dissipative. A recommended value for teno_CT is <span class="tt">1e-6</span>. When adjusting this parameter, it is recommended to try values like <span class="tt">1e-5</span> or <span class="tt">1e-7</span> for TENO5. A smaller value can be used for TENO7.</li>
<li><span class="tt">null_weights</span> activates nullification of the nonlinear WENO weights at the buffer regions outside the domain boundaries when the Riemann extrapolation boundary condition is specified (<span class="tt">bc_[x,y,z]%beg[end]} = -4</span>).</li>
<li><span class="tt">mp_weno</span> activates monotonicity preservation in the WENO reconstruction (MPWENO) such that the values of reconstructed variables do not reside outside the range spanned by WENO stencil (Balsara and Shu <a class="el" href="citelist.html#CITEREF_balsara00">[4]</a>; Suresh and Huynh <a class="el" href="citelist.html#CITEREF_suresh97">[45]</a>).</li>
<li><span class="tt">muscl_order</span> specifies the order of the MUSCL scheme that is used for spatial reconstruction of variables by an integer of 1, or 2, that corresponds to the 1st, and 2nd order respectively. When using <span class="tt">muscl_order = 2</span>, <span class="tt">muscl_lim</span> must be defined.</li>
<li><span class="tt">muscl_lim</span> specifies the slope limiter that is used in 2nd order MUSCL Reconstruction by an integer from 1 through 5. <span class="tt">muscl_lim = 1</span>, <span class="tt">2</span>, <span class="tt">3</span>, <span class="tt">4</span>, and <span class="tt">5</span> correspond to minmod, monotonized central, Van Albada, Van Leer, and SUPERBEE, respectively.</li>
<li><span class="tt">int_comp</span> activates interface compression using THINC used in MUSCL Reconstruction, with control parameters (<span class="tt">ic_eps</span>, and <span class="tt">ic_beta</span>).</li>
<li><span class="tt">riemann_solver</span> specifies the choice of the Riemann solver that is used in simulation by an integer from 1 through 4. <span class="tt">riemann_solver = 1</span>, <span class="tt">2</span>, and <span class="tt">3</span> correspond to HLL, HLLC, and Exact Riemann solver, respectively (Toro <a class="el" href="citelist.html#CITEREF_toro09">[51]</a>). <span class="tt">riemann_solver = 4</span> is only for MHD simulations. It resolves 5 of the full seven-wave structure of the MHD equations (Miyoshi and Kusano <a class="el" href="citelist.html#CITEREF_miyoshi05">[35]</a>).</li>
<li><span class="tt">low_Mach</span> specifies the choice of the low Mach number correction scheme for the HLLC Riemann solver. <span class="tt">low_Mach = 0</span> is default value and does not apply any correction scheme. <span class="tt">low_Mach = 1</span> and <span class="tt">2</span> apply the anti-dissipation pressure correction method (Chen et al. <a class="el" href="citelist.html#CITEREF_chen22">[11]</a>) and the improved velocity reconstruction method (Thornber et al. <a class="el" href="citelist.html#CITEREF_thornber08">[49]</a>). This feature requires <span class="tt">model_eqns = 2</span> or <span class="tt">3</span>. <span class="tt">low_Mach = 1</span> works for <span class="tt">riemann_solver = 1</span> and <span class="tt">2</span>, but <span class="tt">low_Mach = 2</span> only works for <span class="tt">riemann_solver = 2</span>.</li>
<li><span class="tt">avg_state</span> specifies the choice of the method to compute averaged variables at the cell-boundaries from the left and the right states in the Riemann solver by an integer of 1 or 2. <span class="tt">avg_state = 1</span> and <span class="tt">2</span> correspond to Roe- and arithmetic averages, respectively.</li>
<li><span class="tt">wave_speeds</span> specifies the choice of the method to compute the left, right, and middle wave speeds in the Riemann solver by an integer of 1 and 2. <span class="tt">wave_speeds = 1</span> and <span class="tt">2</span> correspond to the direct method (Batten et al. <a class="el" href="citelist.html#CITEREF_batten97">[5]</a>), and indirect method that approximates the pressures and velocity (Toro <a class="el" href="citelist.html#CITEREF_toro09">[51]</a>), respectively.</li>
<li><span class="tt">weno_Re_flux</span> activates the scalar divergence theorem in computing the velocity gradients using WENO-reconstructed cell boundary values. If this option is false, velocity gradient is computed using finite difference scheme of order 2 which is independent of the WENO order.</li>
<li><span class="tt">weno_avg</span> it activates the arithmetic average of the left and right, WENO-reconstructed, cell-boundary values. This option requires <span class="tt">weno_Re_flux</span> to be true because cell boundary values are only utilized when employing the scalar divergence method in the computation of velocity gradients.</li>
<li><span class="tt">surface_tension</span> activates surface tension when set to <span class="tt">'T'</span>. Requires <span class="tt">sigma</span> to be set and <span class="tt">num_fluids</span>. The color function in each patch should be assigned such that <span class="tt">patch_icpp(i)%cf_val = 1</span> in patches where <span class="tt">patch_icpp(i)%alpha = 1 - eps</span> and <span class="tt">patch_icpp(i)%cf_val = 0</span> in patches where <span class="tt">patch_icpp(i)%alpha = eps</span>.</li>
<li><span class="tt">viscous</span> activates viscosity when set to <span class="tt">'T'</span>. Requires <span class="tt">Re(1)</span> and <span class="tt">Re(2)</span> to be set.</li>
<li><span class="tt">hypoelasticity</span> activates elastic stress calculations for fluid-solid interactions. Requires <span class="tt">G</span> to be set in the fluid material's parameters.</li>
</ul>
<h4 class="doxsection"><a class="anchor" id="boundary-condition-patches"></a>
Boundary Condition Patches</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">num_bc_patches</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of boundary condition patches  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">dir</span>*  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Direction of the boundary patch. [1]: x; [2]: y; [3]: z  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">loc</span>*  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Location of the patch in the domain  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">type</span>*  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">The geometry of the patch. [1]: Line [2]: Circle [3]: Rectangle  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">x[y,z]_centroid</span>*  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Centroid of the boundary patch in the x[y,z]-direction  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">length_x[y,z]</span>*  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Length of the boundary patch in the x[y,z]-direction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">radius</span>*  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Radius of the boundary patch  </td></tr>
</table>
<p>*: These parameters should be prepended with <span class="tt">patch_bc(j)%</span> where $j$ is the patch index.</p>
<p>Boundary condition patches can be used with the following boundary condition types:</p><ul>
<li><span class="tt">-2</span> reflective</li>
<li><span class="tt">-3</span> ghost cell extrapolation</li>
<li><span class="tt">-15</span> slip wall</li>
<li><span class="tt">-16</span> no-slip wall</li>
<li><span class="tt">-17</span> Dirichlet</li>
</ul>
<p>Line segments along each domain edge are supported for 2D simulations. Squares and circles on each face are supported for 3D simulations.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Constant Time-Stepping</h4>
<ul>
<li><span class="tt">dt</span> specifies the constant time step size used in the simulation. The value of <span class="tt">dt</span> needs to be sufficiently small to satisfy the Courant-Friedrichs-Lewy (CFL) condition.</li>
<li><span class="tt">t_step_start</span> and <span class="tt">t_step_stop</span> define the time steps at which the simulation starts and ends.</li>
</ul>
<p><span class="tt">t_step_save</span> is the time step interval for data output during simulation. To newly start the simulation, set <span class="tt">t_step_start = 0</span>. To restart the simulation from $k$-th time step, set <span class="tt">t_step_start = k</span>; see <a class="el" href="running.html" title="Running">Restarting Cases</a>.</p>
<h5 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Adaptive Time-Stepping</h5>
<ul>
<li><span class="tt">cfl_adap_dt</span> enables adaptive time stepping with a constant CFL when true</li>
<li><span class="tt">cfl_const_dt</span> enables constant <span class="tt">dt</span> time-stepping where <span class="tt">dt</span> results in a specified CFL for the initial condition</li>
<li><span class="tt">cfl_target</span> specifies the target CFL value</li>
<li><span class="tt">n_start</span> specifies the save file to start at</li>
<li><span class="tt">t_save</span> specifies the time interval between data output during the simulation</li>
<li><span class="tt">t_stop</span> specifies at what time the simulation should stop</li>
</ul>
<p>To newly start the simulation, set <span class="tt">n_start = 0</span>. To restart the simulation from $k$-th time step, see <a class="el" href="running.html" title="Running">Restarting Cases</a>.</p>
<h3 class="doxsection"><a class="anchor" id="sec-formatted-output"></a>
7. Formatted Output</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">format</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Output format. [1]: Silo-HDF5; [2] Binary  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">precision</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">[1] Single; [2] Double  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">parallel_io</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Parallel I/O  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">file_per_process</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Whether or not to write one IO file per process  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cons_vars_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write conservative variables  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">prim_vars_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write primitive variables  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">alpha_rho_wrt(i)</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the partial density of the fluid $i$ to the database |  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">rho_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the mixture density to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">mom_wrt(i)</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the $i$-direction momentum to the database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">vel_wrt(i)</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the $i$-direction velocity to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">E_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the total energy to the database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">pres_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the pressure to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">alpha_wrt(i)</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the volume fraction of fluid $i$ to the database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">gamma_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the specific heat ratio function to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">heat_ratio_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the specific heat ratio to the database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">pi_inf_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the liquid stiffness function to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">pres_inf_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the liquid stiffness to the formatted database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">c_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the sound speed to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">omega_wrt(i)</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the $i$-direction vorticity to the database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">schlieren_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the numerical schlieren to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">qm_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the Q-criterion to the database  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">liutex_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the Liutex to the database  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">fd_order</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Order of finite differences for computing the vorticity and the numerical Schlieren function [1,2,4]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">schlieren_alpha(i)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Intensity of the numerical Schlieren computed via <span class="tt">alpha(i)</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">probe_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write the flow chosen probes data files for each time step  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">num_probes</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of probes  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">probe(i)%[x,y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Coordinates of probe $i$  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">output_partial_domain</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Output part of the domain  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">[x,y,z]_output%beg</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Beginning of the output domain in the [x,y,z]-direction  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">[x,y,z]_output%end</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">End of the output domain in the [x,y,z]-direction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_txt_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write Lagrangian bubble data to <span class="tt">.dat</span> files  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_header</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write header to Lagrangian bubble <span class="tt">.dat</span> files  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_db_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write Lagrangian bubble data to silo/hdf5 database files  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_id_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the global bubble idea to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_pos_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble position to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_pos_prev_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the previous bubble position to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_vel_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble translational velocity to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_rad_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble radius to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_rvel_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble radial velocity to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_r0_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble initial radius to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_rmax_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble maximum radius to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_rmin_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble minimum radius to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_dphidt_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble subgrid velocity potential to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_pres_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble pressure to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_mv_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble vapor mass to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_mg_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble gas mass to the database file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">lag_betaT_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble heat flux model coefficient to the database file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">lag_betaC_wrt</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Add the bubble mass flux model coefficient to the database file  </td></tr>
</table>
<p>The table lists formatted database output parameters. The parameters define variables that are outputted from simulation and file types and formats of data as well as options for post-processing.</p>
<ul>
<li><span class="tt">format</span> specifies the choice of the file format of data file outputted by MFC by an integer of 1 and 2. <span class="tt">format = 1</span> and <span class="tt">2</span> correspond to Silo-HDF5 format and binary format, respectively.</li>
<li><span class="tt">precision</span> specifies the choice of the floating-point format of the data file outputted by MFC by an integer of 1 and 2. <span class="tt">precision = 1</span> and <span class="tt">2</span> correspond to single-precision and double-precision formats, respectively.</li>
<li><span class="tt">parallel_io</span> activates parallel input/output (I/O) of data files. It is highly recommended to activate this option in a parallel environment. With parallel I/O, MFC inputs and outputs a single file throughout pre-process, simulation, and post-process, regardless of the number of processors used. Parallel I/O enables the use of different numbers of processors in each process (e.g., simulation data generated using 1000 processors can be post-processed using a single processor).</li>
<li><span class="tt">file_per_process</span> deactivates shared file MPI-IO and activates file per process MPI-IO. The default behavior is to use a shared file. File per process is useful when running on &gt;10K ranks. If <span class="tt">file_per_process</span> is true, then pre_process, simulation, and post_process must be run with the same number of ranks.</li>
<li><span class="tt">cons_vars_wrt</span> and <span class="tt">prim_vars_wrt</span> activate the output of conservative and primitive state variables into the database.</li>
<li><span class="tt">[variable's name]_wrt</span> activates the output of each specified variable into the database.</li>
<li><span class="tt">schlieren_alpha(i)</span> specifies the intensity of the numerical Schlieren of $i$-th component.</li>
<li><span class="tt">fd_order</span> specifies the order of the finite difference scheme used to compute the vorticity from the velocity field and the numerical schlieren from the density field using an integer of 1, 2, and 4. <span class="tt">fd_order = 1</span>, <span class="tt">2</span>, and <span class="tt">4</span> correspond to the first, second, and fourth-order finite difference schemes.</li>
<li><span class="tt">probe_wrt</span> activates the output of state variables at coordinates specified by <span class="tt">probe(i)%[x;y,z]</span>.</li>
<li><span class="tt">output_partial_domain</span> activates the output of part of the domain specified by <span class="tt">[x,y,z]_output%beg</span> and <span class="tt">[x,y,z]_output%end</span>. This is useful for large domains where only a portion of the domain is of interest. It is not supported when <span class="tt">precision = 1</span> and <span class="tt">format = 1</span>. It also cannot be enabled with <span class="tt">flux_wrt</span>, <span class="tt">heat_ratio_wrt</span>, <span class="tt">pres_inf_wrt</span>, <span class="tt">c_wrt</span>, <span class="tt">omega_wrt</span>, <span class="tt">ib</span>, <span class="tt">schlieren_wrt</span>, <span class="tt">qm_wrt</span>, or 'liutex_wrt'.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-acoustic-source"></a>
8. Acoustic Source</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic_source</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Acoustic source module activation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">num_source</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of acoustic sources  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%support</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Geometry of spatial support for the acoustic source  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%dipole</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Dipole source activation (optional; default = false -&gt; monopole)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%loc(j)</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">$j$-th coordinate of the point that defines the acoustic source location  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%pulse</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Acoustic wave form: [1] Sine [2] Gaussian [3] Square [4] Broadband  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%npulse</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Number of pulse cycles  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%mag</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Pulse magnitude  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%frequency</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Sine/Square - Frequency of the acoustic wave (exclusive)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%wavelength</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Sine/Square - Wavelength of the acoustic wave (exclusive)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%gauss_sigma_time</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Gaussian - Gaussian pulse time width in terms of sigma (exclusive)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%gauss_sigma_dist</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Gaussian - Gaussian pulse spatial width in terms of sigma (exclusive)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%delay</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Time delay of the acoustic wave (optional for <span class="tt">%pulse = 1</span> or <span class="tt">3</span>; default = 0)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%dir</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Planer - Direction of acoustic propagation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%length</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">2D/3D Planer - Spatial pulse length  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%height</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">3D Planer - Spatial pulse height  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%foc_length</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Transducer - Focal length of the transducer  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%aperture</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Transducer - Aperture of the transducer  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%num_elements</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Transducer array - Number of transducer elements in a transducer array  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%element_on</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Transducer array - Element number that is on (optional; default = 0 -&gt; all elements)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%element_spacing_angle</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">2D Transducer array - Spacing angle (in rad) between adjacent transducer elements  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%element_polygon_ratio</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">3D Transducer array - Ratio of polygon side length to transducer element radius  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%rotate_angle</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">3D Transducer array - Rotation angle of the transducer array (optional; default = 0)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%bb_num_freq</span>  </td><td class="markdownTableBodyCenter">integer  </td><td class="markdownTableBodyLeft">Number of frequencies in broadband wave  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%bb_bandwidth</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">The bandwidth of each frequency in the broadband wave  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">acoustic(i)%bb_lowest_freq</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">The lower frequency bound of the broadband wave  </td></tr>
</table>
<p>Details of the transducer acoustic source model can be found in Maeda and Colonius <a class="el" href="citelist.html#CITEREF_maeda17">[29]</a>.</p>
<ul>
<li><span class="tt">acoustic_source</span> activates the acoustic source module.</li>
<li><span class="tt">num_source</span> defines the total number of source planes by an integer.</li>
<li><span class="tt">%support</span> specifies the choice of the geometry of acoustic source distribution. See table <a class="el" href="#acoustic-supports" title="Acoustic Supports">Acoustic Supports</a> for details.</li>
<li><span class="tt">%dipole</span> changes the default monopole (one-sided) source to a dipole source. It is only available for planar waves.</li>
<li><span class="tt">%loc(j)</span> specifies the location of the acoustic source in the $j$-th coordinate direction. For planer support, the location defines midpoint of the source plane. For transducer arrays, the location defines the center of the transducer or transducer array (not the focal point; for 3D it's the tip of the spherical cap, for 2D it's the tip of the arc).</li>
<li><span class="tt">%pulse</span> specifies the acoustic wave form. <span class="tt">%pulse = 1</span>, <span class="tt">2</span>, <span class="tt">3</span> and <span class="tt">4</span> correspond to sinusoidal wave, Gaussian wave, square wave and broadband wave, respectively. The implementation of the broadband wave is based on Tam et al. <a class="el" href="citelist.html#CITEREF_tam05">[46]</a></li>
<li><span class="tt">%npulse</span> specifies the number of cycles of the acoustic wave generated. Only applies to <span class="tt">%pulse = 1 and 3</span> (sine and square waves), and must be an integer for non-planar waves.</li>
<li><span class="tt">%mag</span> specifies the peak amplitude of the acoustic wave.</li>
<li><span class="tt">%frequency</span> and <span class="tt">%wavelength</span> specify the frequency and wavelength of the acoustic wave, respectively. These parameters are exclusive and exactly one of them must be specified for <span class="tt">%pulse = 1</span> or <span class="tt">3</span> (sine or square waves). They are related by the speed of sound in the medium: <span class="tt">frequency = speed_of_sound / wavelength</span>.</li>
<li><span class="tt">%gauss_sigma_time</span> and <span class="tt">%gauss_sigma_dist</span> specify the time and spatial widths of the Gaussian pulse in terms of sigma, respectively. In particular, <span class="tt">%gauss_sigma_time</span> is the standard deviation in the Gaussian equation. These parameters are exclusive and exactly one of them must be specified for <span class="tt">%pulse = 2</span> (Gaussian wave). They are related by the speed of sound in the medium: <span class="tt">gauss_sigma_dist = speed_of_sound * gauss_sigma_time</span>.</li>
<li><span class="tt">%delay</span> specifies the time delay of the acoustic wave. This parameter is optional for <span class="tt">%pulse = 1</span> or <span class="tt">3</span> (sine or square waves) and defaults to 0. It must be specified for <span class="tt">%pulse = 2</span> (Gaussian wave). It is important to note that setting the delay to 0 for a Gaussian pulse results in a half-Gaussian pulse, and delays that are too small may result in the pulse being cut off at the start of the simulation. <span class="tt">4*gauss_sigma_time</span> is a typical value for the delay of a Gaussian pulse.</li>
<li><span class="tt">%dir</span> specifies the direction of acoustic wave propagation for planar waves. The direction is defined by the angle in degrees from the x-axis in the x-y plane. It applies to both 2D and 3D simulation of planar waves (support is infinite in z-direction for 3D).</li>
<li><span class="tt">%length</span> specifies the spatial length of the 2D or 3D planar wave. It is the length of the source plane perpendicular to the direction of wave propagation.</li>
<li><span class="tt">%height</span> specifies the spatial height of the planar wave. Since <span class="tt">%dir</span> is in the x-y plane, the height is perpendicular to the direction of wave propagation.</li>
<li><span class="tt">%foc_length</span> specifies the focal length of the transducer for transducer waves. It is the distance from the transducer to the focal point.</li>
<li><span class="tt">%aperture</span> specifies the aperture of the transducer. It is the diameter of the projection of the transducer arc onto the y-axis (2D) or spherical cap onto the y-z plane (3D). Set the aperture to double the focal length to simulate a transducer enclosing half of the circle/sphere. For the transducer array, it is the total aperture of the array.</li>
<li><span class="tt">%num_elements</span> specifies the number of transducer elements in a transducer array.</li>
<li><span class="tt">%element_on</span> specifies the element number of the transducer array that is on. The element number starts from 1, if all elements are on, set <span class="tt">%element_on</span> to 0.</li>
<li><span class="tt">%element_spacing_angle</span> specifies the spacing angle between adjacent transducers in radians. The total aperture (<span class="tt">%aperture</span>) is set, so each transducer element is smaller if <span class="tt">%element_spacing_angle</span> is larger.</li>
<li><span class="tt">%element_polygon_ratio</span> specifies the ratio of the polygon side length to the aperture diameter of each transducer element in a circular 3D transducer array. The polygon side length is calculated by using the total aperture (<span class="tt">%aperture</span>) as the circumcircle diameter and <span class="tt">%num_elements</span> as the number of sides of the polygon. The ratio is used to specify the aperture size of each transducer element in the array as a ratio of the total aperture.</li>
<li><span class="tt">%rotate_angle</span> specifies the rotation angle of the 3D circular transducer array along the x-axis (principal axis). It is optional and defaults to 0.</li>
<li><span class="tt">%bb_num_freq</span> specifies the number discretized frequencies in the broadband acoustic wave. If <span class="tt">%bb_num_freq</span> is 1, the acoustic wave will be a discrete tone (i.e. single frequency sine wave).</li>
<li><span class="tt">%bb_bandwidth</span> specifies the bandwidth of the discretized frequencies.</li>
<li><span class="tt">%bb_lowest_freq</span> specifies the lower frequency bound of the broadband acoustic wave. The upper frequency bound will be calculated as <span class="tt">%bb_lowest_freq + %bb_num_freq * %bb_bandwidth</span>. The wave is no longer broadband below the lower bound and above the upper bound.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-bubble-models"></a>
9. Sub-grid Bubble Models</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bubbles_euler</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Ensemble-averaged bubble modeling  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bubbles_lagrange</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Volume-averaged bubble modeling  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bubble_model</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">[1] Gilmore; [2] Keller&ndash;Miksis; [3] Rayleigh-Plesset  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%R0ref</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Reference bubble radius  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%p0ref</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Reference pressure  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%rho0ref</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Reference density  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%T0ref</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Reference temperature  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%ss</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Surface tension between host and gas (bubble)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%pv</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Vapor pressure of host  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%vd</span>† ‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Vapor diffusivity in gas (bubble)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%mu_l</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Viscosity of host in liquid state  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%mu_v</span>†  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Viscosity of host in vapor state  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%mu_g</span>†  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Viscosity of gas (bubble)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%gam_v</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Specific heat ratio of host in vapor state  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%gam_g</span>*†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Specific heat ratio of gas (bubble)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%M_v</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Molecular weight of host  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%M_g</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Molecular weight of gas (bubble)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%k_v</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Thermal conductivity of host in vapor state  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%k_g</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Thermal conductivity of gas (bubble)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%cp_v</span>‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Specific heat capacity in constant pressure of host in vapor state  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%cp_g</span>‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Specific heat capacity in constant pressure of gas (bubble)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%R_v</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Gas constant of host in vapor state  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bub_pp%R_g</span>†‡  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Gas constant of gas (bubble)  </td></tr>
</table>
<ul>
<li>* These parameters are required for ensemble-averaged bubble model.</li>
<li>† These parameters are required for ensemble-averaged bubble model with <span class="tt">polytropic = F</span>.</li>
<li>‡ These parameters are required for volume-averaged bubble model with <span class="tt">polytropic = F</span>.</li>
</ul>
<p>This table lists the sub-grid bubble model parameters, which can be utilized in both the ensemble-averaged and volume-averaged bubble models.</p>
<ul>
<li><span class="tt">bubbles_euler</span> activates the ensemble-averaged bubble model.</li>
<li><span class="tt">bubbles_lagrange</span> activates the volume-averaged bubble model.</li>
<li><span class="tt">bubble_model</span> specifies a model for spherical bubble dynamics by an integer of <span class="tt">1</span>, <span class="tt">2</span>, or <span class="tt">3</span>. <span class="tt">bubble_model = 1</span>, <span class="tt">2</span>, and <span class="tt">3</span> correspond to the Gilmore, Keller-Miksis, and Rayleigh-Plesset models.</li>
<li><span class="tt">bub_pp</span> specifies simulation parameters for the EE and/or EL bubble model.</li>
</ul>
<p>Implementation of the parameters into the model follows Ando <a class="el" href="citelist.html#CITEREF_ando10">[3]</a>.</p>
<p>See <a class="el" href="equations.html" title="Equations">Equations</a> Section 9 for the bubble dynamics equations.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
9.1 Ensemble-Averaged Bubble Model</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bubbles_euler</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Ensemble-averaged bubble modeling  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">polytropic</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Polytropic gas compression  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">thermal</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Thermal model: [1] Adiabatic; [2] Isothermal; [3] Transfer  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">polydisperse</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Polydispersity in equilibrium bubble radius R0  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">nb</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Number of bins: [1] Monodisperse; [$&gt;1$] Polydisperse  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">poly_sigma</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Standard deviation for probability density function of polydisperse bubble populations  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">qbmm</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Quadrature by method of moments  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">dist_type</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Joint probability density function for bubble radius and velocity (only for <span class="tt">qbmm = 'T'</span>)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">sigR</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Standard deviation for the probability density function of bubble radius (only for <span class="tt">qbmm = 'T'</span>) (EE)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">sigV</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Standard deviation for the probability density function of bubble velocity (only for <span class="tt">qbmm = 'T'</span>) (EE)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">rhoRV</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Correlation coefficient for the joint probability density function of bubble radius and velocity (only for <span class="tt">qbmm = 'T'</span>)  </td></tr>
</table>
<p>This table lists the ensemble-averaged bubble model parameters.</p>
<ul>
<li><span class="tt">polytropic</span> activates polytropic gas compression in the bubble. When <span class="tt">polytropic = 'F'</span>, the gas compression is modeled as non-polytropic due to heat and mass transfer across the bubble wall with constant heat and mass transfer coefficients based on (Preston et al. <a class="el" href="citelist.html#CITEREF_preston07">[38]</a>).</li>
<li><span class="tt">thermal</span> specifies a model for heat transfer across the bubble interface by an integer from 1 through 3. <span class="tt">thermal = 1</span>, <span class="tt">2</span>, and <span class="tt">3</span> correspond to no heat transfer (adiabatic gas compression), isothermal heat transfer, and heat transfer with a constant heat transfer coefficient based on Preston et al. <a class="el" href="citelist.html#CITEREF_preston07">[38]</a>, respectively.</li>
<li><span class="tt">polydisperse</span> activates polydispersity in the bubble model through a probability density function (PDF) of the equilibrium bubble radius. Simpson's rule is used for integrating the log-normal PDF of equilibrium bubble radius for polydisperse populations.</li>
<li><span class="tt">nb</span> specifies the number of discrete bins that define the probability density function (PDF) of the equilibrium bubble radius.</li>
<li><span class="tt">poly_sigma</span> specifies the standard deviation of the log-normal PDF of equilibrium bubble radius for polydisperse populations.</li>
<li><span class="tt">qbmm</span> activates quadrature by method of moments, which assumes a PDF for bubble radius and velocity.</li>
<li><span class="tt">dist_type</span> specifies the initial joint PDF of initial bubble radius and bubble velocity required in qbmm. <span class="tt">dist_type = 1</span> and <span class="tt">2</span> correspond to binormal and lognormal-normal distributions respectively.</li>
<li><span class="tt">sigR</span> specifies the standard deviation of the PDF of bubble radius required in the QBMM feature.</li>
<li><span class="tt">sigV</span> specifies the standard deviation of the PDF of bubble velocity required in the QBMM feature.</li>
<li><span class="tt">rhoRV</span> specifies the correlation coefficient of the joint PDF of bubble radius and bubble velocity required in the QBMM feature.</li>
</ul>
<h4 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
9.2 Volume-Averaged Bubble Model</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bubbles_lagrange</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Lagrangian subgrid bubble model switch  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">nBubs_glb</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Global number of bubbles  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">solver_approach</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">1: One-way coupling, 2: two-way coupling  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">cluster_type</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Method to find p_inf  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">pressure_corrector</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Cell pressure correction term  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">smooth_type</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Smoothing function. 1: Gaussian, 2:Delta 3x3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">heatTransfer_model</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Activates the interface heat transfer model  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">massTransfer_model</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Activates the interface mass transfer model  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">write_bubbles</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write files to track the bubble evolution each time step  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">write_bubbles_stats</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Write the maximum and minimum radius of each bubble  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">epsilonb</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Standard deviation scaling for the gaussian function  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">charwidth</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Domain virtual depth (z direction, for 2D simulations)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">valmaxvoid</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Maximum void fraction permitted  </td></tr>
</table>
<ul>
<li><span class="tt">nBubs_glb</span> Total number of bubbles. Their initial conditions need to be specified in the ./input/lag_bubbles.dat file. See the example cases for additional information.</li>
<li><span class="tt">solver_approach</span> Specifies the Euler-Lagrange coupling method: [1] enables a one-way coupling approach, where the bubbles do not influence the Eulerian field. [2] activates the two-way coupling approach based on Maeda and Colonius <a class="el" href="citelist.html#CITEREF_maeda18">[30]</a>, where the effect of the bubbles is added in the Eulerian field as source terms.</li>
<li><span class="tt">cluster_type</span> Specifies method to find p_inf (pressure that drives the bubble dynamics): [1] activates the bilinear interpolation of the pressure field, while [2] enables the bubble dynamic closure based on Maeda and Colonius <a class="el" href="citelist.html#CITEREF_maeda18">[30]</a>, the full model is obtained when <span class="tt">pressure_corrector</span> is true.</li>
<li><span class="tt">smooth_type</span> Specifies the smoothening method of projecting the lagrangian bubbles in the Eulerian field: [1] activates the gaussian kernel function described in Maeda and Colonius <a class="el" href="citelist.html#CITEREF_maeda18">[30]</a>, while [2] activates the delta kernel function where the effect of the bubble is only seen in the specific bubble location cell.</li>
<li><span class="tt">heatTransfer_model</span> Activates the heat transfer model at the bubble's interface based on (Preston et al. <a class="el" href="citelist.html#CITEREF_preston07">[38]</a>).</li>
<li><span class="tt">massTransfer_model</span> Activates the mass transfer model at the bubble's interface based on (Preston et al. <a class="el" href="citelist.html#CITEREF_preston07">[38]</a>).</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-velocity-field-setup"></a>
10. Velocity Field Setup</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">perturb_flow</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Perturb the initial velocity field by random noise  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">perturb_flow_fluid</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Fluid density whose flow is to be perturbed  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">perturb_flow_mag</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Set the magnitude of flow perturbations  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">perturb_sph</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Perturb the initial partial density by random noise  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">perturb_sph_fluid</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Fluid component whose partial density is to be perturbed  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">mixlayer_vel_profile</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Set the mean streamwise velocity to hyperbolic tangent profile  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">mixlayer_vel_coef</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Coefficient for the hyperbolic tangent profile of a mixing layer  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">mixlayer_perturb</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Perturb the initial velocity field using a spectrum-based synthetic turbulence generation method  </td></tr>
</table>
<p>The table lists velocity field parameters. The parameters are optionally used to define initial velocity profiles and perturbations.</p>
<ul>
<li><span class="tt">perturb_flow</span> activates the perturbation of initial velocity by random noise.</li>
<li><span class="tt">perturb_flow_fluid</span> specifies the fluid component whose flow will be perturbed.</li>
<li><span class="tt">perturb_flow</span> activates the perturbation of initial velocity by random noise.</li>
<li><span class="tt">perturb_sph</span> activates the perturbation of initial partial density by random noise.</li>
<li><span class="tt">perturb_sph_fluid</span> specifies the fluid component whose partial density is to be perturbed.</li>
<li><span class="tt">mixlayer_vel_profile</span> activates setting the mean streamwise velocity to a hyperbolic tangent profile. This option works only for <span class="tt">n &gt; 0</span>.</li>
<li><p class="startli"><span class="tt">mixlayer_vel_coef</span> is a parameter for the hyperbolic tangent profile of a mixing layer when <span class="tt">mixlayer_vel_profile = 'T'</span>. The mean streamwise velocity profile is given as:</p>
<p class="formulaDsp">
\[ u = \text{patch\_icpp(1)\%vel(1)} \cdot \tanh( y_{cc} \cdot \text{mixlayer\_vel\_coef}) \]
</p>
</li>
<li><span class="tt">mixlayer_perturb</span> activates the velocity perturbation for a temporal mixing layer with hyperbolic tangent mean streamwise velocity profile, using an inverter version of the spectrum-based synthetic turbulence generation method proposed by Guo et al. <a class="el" href="citelist.html#CITEREF_guo23">[19]</a>. This option only works for <span class="tt">p &gt; 0</span> and <span class="tt">mixlayer_vel_profile = 'T'</span>.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-phase-change"></a>
11. Phase Change Model</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">relax</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Activates Phase Change model  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">relax_model</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Phase change model: [5] pT-equilibrium; [6] pTg-equilibrium  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">palpha_eps</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">tolerance of the Newton Solver to activate pT-equilibrium  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">ptgalpha_eps</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">tolerance of the Newton Solver to activate pTg-equilibrium  </td></tr>
</table>
<ul>
<li><span class="tt">relax</span> Activates the Phase Change model.</li>
<li><span class="tt">relax_model</span> Specifies the phase change model to be used: [5] enables pT-equilibrium, while [6] activates pTg-equilibrium (if criteria are met).</li>
<li><span class="tt">palpha_eps</span> Specifies the tolerance for the Newton Solvers used in the pT-equilibrium model.</li>
<li><span class="tt">ptgalpha_eps</span> Specifies the tolerance used for the Newton Solvers used in the pTg-equilibrium model.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="sec-artificial-mach-number"></a>
12. Artificial Mach Number</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">pi_fac</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Ratio of artificial and true <span class="tt">pi_\infty</span> values  </td></tr>
</table>
<ul>
<li><span class="tt">pi_fac</span> specifies the ratio of artificial and true <span class="tt">pi_\infty</span> values (<span class="tt">=</span> artificial <span class="tt">pi_\infty</span> / true <span class="tt">pi_\infty</span>). This parameter enables the use of true <span class="tt">pi_\infty</span> in bubble dynamics models when the <span class="tt">pi_\infty</span> given in the <span class="tt">case.py</span> file is an artificial value.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
13. Body Forces</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bf_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable body forces in the x[y,z] direction  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">k_x[y,y]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Magnitude of oscillating acceleration  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">w_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Frequency of oscillating acceleration  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">p_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Phase shift of oscillating acceleration  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">g_x[y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Magnitude of background acceleration  </td></tr>
</table>
<p><span class="tt">k_x[y,z]</span>, <span class="tt">w_x[y,z]</span>, <span class="tt">p_x[y,z]</span>, and <span class="tt">g_x[y,z]</span> define an oscillating acceleration in the <span class="tt">x[y,z]</span> direction with the form</p>
<p class="formulaDsp">
\[ a_{x[y,z]} = g_{x[y,z]} + k_{x[y,z]}\sin\left(w_{x[y,z]}t + p_{x[y,z]}\right). \]
</p>
<p>By convention, positive accelerations in the <span class="tt">x[y,z]</span> direction are in the positive <span class="tt">x[y,z]</span> direction.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md16"></a>
14. Magnetohydrodynamics (MHD)</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">mhd</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable ideal MHD simulation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">relativity</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable relativistic MHD simulation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">hyper_cleaning</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable hyperbolic (GLM) divergence cleaning for <span class="tt">div B</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">hyper_cleaning_speed</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Cleaning wave speed <span class="tt">c_h</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">hyper_cleaning_tau</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Cleaning damping timescale <span class="tt">tau</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">Bx[y,z]</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Initial magnetic field in the x[y,z] direction  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">Bx0</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Constant magnetic field in the x direction (1D only)  </td></tr>
</table>
<ul>
<li><span class="tt">mhd</span> is currently only available for single-component flows and 5-equation model. Its compatibility with most other features is work in progress.</li>
<li><span class="tt">relativity</span> only works for <span class="tt">mhd</span> enabled and activates relativistic MHD (RMHD) simulation.</li>
<li><span class="tt">hyper_cleaning</span> Dedner et al. <a class="el" href="citelist.html#CITEREF_dedner02">[15]</a> only works with <span class="tt">mhd</span> in 2D/3D and reduces numerical <span class="tt">div B</span> errors by propagation and damping. Currently not compatible with HLLD (<span class="tt">riemann_solver = 4</span>).</li>
<li><span class="tt">hyper_cleaning_speed</span> sets the propagation speed of divergence-cleaning waves.</li>
<li><span class="tt">hyper_cleaning_tau</span> sets the decay timescale for divergence-cleaning.</li>
<li><span class="tt">Bx0</span> is only used in 1D simulations to specify the constant magnetic field in the x direction. It must be specified in 1D simulations. <span class="tt">Bx</span> must not be used in 1D simulations.</li>
<li><span class="tt">Bx</span>, <span class="tt">By</span>, and <span class="tt">Bz</span> are used to specify the initial magnetic field in the x, y, and z directions, respectively. They must be specified in all 1D/2D/3D MHD simulations, with the exception of <span class="tt">Bx</span> in 1D simulations.</li>
</ul>
<p>Note: In 1D/2D/3D simulations, all three velocity components are treated as state variables and must be specified in the case file.</p>
<p>Note: For relativistic flow, the conservative and primitive densities are different. <span class="tt">rho_wrt</span> outputs the primitive (rest mass) density.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md17"></a>
15. Elasticity</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">hypoelasticity</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable hypoelasticity simulation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">hyperelasticity</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable hyperelasticity simulation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cont_damage</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable continuum damage model  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">tau_star</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Threshold stress for continuum damage model  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">cont_damage_s</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Power <span class="tt">s</span> for continuum damage model  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">alpha_bar</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Damage factor (rate) for continuum damage model  </td></tr>
</table>
<ul>
<li><span class="tt">cont_damage</span> activates continuum damage model for solid materials. Requires <span class="tt">tau_star</span>, <span class="tt">cont_damage_s</span>, and <span class="tt">alpha_bar</span> to be set (empirically determined) (Cao et al. <a class="el" href="citelist.html#CITEREF_cao19">[10]</a>).</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md18"></a>
16. Cylindrical Coordinates</h3>
<p>When <span class="tt">cyl_coord = 'T'</span> is set in 3D the following constraints must be met:</p>
<ul>
<li><span class="tt">bc_y%beg = -14</span> enables the axis boundary condition</li>
<li><span class="tt">bc_z%beg = bc_z%end = -1</span> enables periodic boundary conditions in the azimuthal direction</li>
<li><span class="tt">z_domain%beg = 0</span> sets the azimuthal starting point to 0</li>
<li><span class="tt">z_domain%end = 2*math.pi</span> to set the azimuthal ending point to \(2\pi\) (note, requires <span class="tt">import math</span> in the case file)</li>
</ul>
<p>When <span class="tt">cyl_coord = 'T'</span> is set in 2D the following constraints must be met:</p>
<ul>
<li><span class="tt">bc_y%beg = -2</span> to enable reflective boundary conditions</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md19"></a>
17. Chemistry</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">chemistry</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable chemistry simulation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">chem_params%diffusion</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable multispecies diffusion  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">chem_params%reactions</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable chemical reactions  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">chem_params%gamma_method</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Methodology for calculating the heat capacity ratio  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">chem_params%transport_model</span>  </td><td class="markdownTableBodyCenter">Integer  </td><td class="markdownTableBodyLeft">Methodology for calculating the diffusion coefficients  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">cantera_file</span>  </td><td class="markdownTableBodyCenter">String  </td><td class="markdownTableBodyLeft">Cantera-format mechanism file (e.g., .yaml)  </td></tr>
</table>
<ul>
<li><span class="tt">chem_params%transport_model</span> specifies the methodology for calculating diffusion coefficients and other transport properties, <span class="tt">1</span> for mixture-average, <span class="tt">2</span> for Unity-Lewis</li>
<li><span class="tt">cantera_file</span> specifies the chemical mechanism file. If the file is part of the standard Cantera library, only the filename is required. Otherwise, the file must be located in the same directory as your <span class="tt">case.py</span> file</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
Enumerations</h2>
<h3 class="doxsection"><a class="anchor" id="boundary-conditions"></a>
Boundary conditions</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">#  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-1  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">Periodic  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-2  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">Reflective  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-3  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">Ghost cell extrapolation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-4  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">Riemann extrapolation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-5  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Slip wall  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-6  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Non-reflecting subsonic buffer  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-7  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Non-reflecting subsonic inflow  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-8  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Non-reflecting subsonic outflow  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-9  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Force-free subsonic outflow  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-10  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Constant pressure subsonic outflow  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-11  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Supersonic inflow  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-12  </td><td class="markdownTableBodyCenter">Characteristic  </td><td class="markdownTableBodyLeft">Supersonic outflow  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-14  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">Axis *  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-15  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">Slip wall  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-16  </td><td class="markdownTableBodyCenter">Normal  </td><td class="markdownTableBodyLeft">No-slip wall  </td></tr>
</table>
<p>*: This boundary condition is only used for <span class="tt">bc_y%beg</span> when using cylindrical coordinates (<span class="tt">cyl_coord = 'T'</span> and 3D). For axisymmetric problems, use <span class="tt">bc_y%beg = -2</span> with <span class="tt">cyl_coord = 'T'</span> in 2D.</p>
<p>The boundary condition supported by the MFC are listed in table <a class="el" href="#boundary-conditions" title="Boundary conditions">Boundary Conditions</a>. Their number (<span class="tt">#</span>) corresponds to the input value in <span class="tt">input.py</span> labeled <span class="tt">bc_[x,y,z]%[beg,end]</span> (see table <a class="el" href="#sec-simulation-algorithm" title="6. Simulation Algorithm">Simulation Algorithm Parameters</a>). The entries labeled "Characteristic." are characteristic boundary conditions based on Thompson <a class="el" href="citelist.html#CITEREF_thompson87">[47]</a> and Thompson <a class="el" href="citelist.html#CITEREF_thompson90">[48]</a>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md21"></a>
Generalized Characteristic Boundary conditions</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Parameter  </th><th class="markdownTableHeadCenter">Type  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%grcbc_in</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable grcbc for subsonic inflow  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%grcbc_out</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable grcbc for subsonic outflow (pressure)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%grcbc_vel_out</span>  </td><td class="markdownTableBodyCenter">Logical  </td><td class="markdownTableBodyLeft">Enable grcbc for subsonic outflow (pressure + normal velocity)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%vel_in</span>  </td><td class="markdownTableBodyCenter">Real Array  </td><td class="markdownTableBodyLeft">Inflow velocities in x, y and z directions  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%vel_out</span>  </td><td class="markdownTableBodyCenter">Real Array  </td><td class="markdownTableBodyLeft">Outflow velocities in x, y and z directions  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%pres_in</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Inflow pressure  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%pres_out</span>  </td><td class="markdownTableBodyCenter">Real  </td><td class="markdownTableBodyLeft">Outflow pressure  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%alpha_rho_in</span>  </td><td class="markdownTableBodyCenter">Real Array  </td><td class="markdownTableBodyLeft">Inflow density  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight"><span class="tt">bc_[x,y,z]%alpha_in</span>  </td><td class="markdownTableBodyCenter">Real Array  </td><td class="markdownTableBodyLeft">Inflow void fraction  </td></tr>
</table>
<p>This boundary condition can be used for subsonic inflow (<span class="tt">bc_[x,y,z]%[beg,end]</span> = -7) and subsonic outflow (<span class="tt">bc_[x,y,z]%[beg,end]</span> = -8) characteristic boundary conditions. These are based on Pirozzoli and Colonius <a class="el" href="citelist.html#CITEREF_pirozzoli13">[36]</a>. This enables to provide inflow and outflow conditions outside the computational domain.</p>
<h3 class="doxsection"><a class="anchor" id="patch-types"></a>
Patch types</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">#  </th><th class="markdownTableHeadCenter">Name  </th><th class="markdownTableHeadCenter">Dim.  </th><th class="markdownTableHeadCenter">Smooth  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">1  </td><td class="markdownTableBodyCenter">Line segment  </td><td class="markdownTableBodyCenter">1  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Requires <span class="tt">x_centroid</span> and <span class="tt">length_x</span>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">2  </td><td class="markdownTableBodyCenter">Circle  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y]_centroid</span> and <span class="tt">radius</span>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">3  </td><td class="markdownTableBodyCenter">Rectangle  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Coordinate-aligned. Requires <span class="tt">[x,y]_centroid</span> and <span class="tt">length_[x,y]</span>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">4  </td><td class="markdownTableBodyCenter">Sweep line  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Not coordinate aligned. Requires <span class="tt">[x,y]_centroid</span> and <span class="tt">normal(i)</span>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">5  </td><td class="markdownTableBodyCenter">Ellipse  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y]_centroid</span> and <span class="tt">radii(i)</span>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">6  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyLeft">No longer exists. Empty.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">7  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyLeft">No longer exists. Empty.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">8  </td><td class="markdownTableBodyCenter">Sphere  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y,z]_centroid</span> and <span class="tt">radius</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">9  </td><td class="markdownTableBodyCenter">Cuboid  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Coordinate-aligned. Requires <span class="tt">[x,y,z]_centroid</span> and <span class="tt">length_[x,y,z]</span>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">10  </td><td class="markdownTableBodyCenter">Cylinder  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y,z]_centroid</span>, <span class="tt">radius</span>, and <span class="tt">length_[x,y,z]</span>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">11  </td><td class="markdownTableBodyCenter">Sweep plane  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Not coordinate-aligned. Requires <span class="tt">x[y,z]_centroid</span> and <span class="tt">normal(i)</span>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">12  </td><td class="markdownTableBodyCenter">Ellipsoid  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y,z]_centroid</span> and <span class="tt">radii(i)</span>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">13  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyLeft">No longer exists. Empty.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">14  </td><td class="markdownTableBodyCenter">Spherical Harmonic  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y,z]_centroid</span>, <span class="tt">radius</span>, <span class="tt">epsilon</span>, <span class="tt">beta</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">15  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyCenter">N/A  </td><td class="markdownTableBodyLeft">No longer exists. Empty.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">16  </td><td class="markdownTableBodyCenter">1D bubble pulse  </td><td class="markdownTableBodyCenter">1  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Requires <span class="tt">x_centroid</span>, <span class="tt">length_x</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">17  </td><td class="markdownTableBodyCenter">Spiral  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y]_centroid</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">18  </td><td class="markdownTableBodyCenter">2D Varcircle  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y]_centroid</span>, <span class="tt">radius</span>, and <span class="tt">thickness</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">19  </td><td class="markdownTableBodyCenter">3D Varcircle  </td><td class="markdownTableBodyCenter">3  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y,z]_centroid</span>, <span class="tt">length_z</span>, <span class="tt">radius</span>, and <span class="tt">thickness</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">20  </td><td class="markdownTableBodyCenter">2D Taylor-Green Vortex  </td><td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">N  </td><td class="markdownTableBodyLeft">Requires <span class="tt">[x,y]_centroid</span>, <span class="tt">length_x</span>, <span class="tt">length_y</span>, <span class="tt">vel(1)</span>, and <span class="tt">vel(2)</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">21  </td><td class="markdownTableBodyCenter">Model  </td><td class="markdownTableBodyCenter">2 &amp; 3  </td><td class="markdownTableBodyCenter">Y  </td><td class="markdownTableBodyLeft">Imports a Model (STL/OBJ). Requires <span class="tt">model_filepath</span>.  </td></tr>
</table>
<p>The patch types supported by the MFC are listed in table <a class="el" href="#patch-types" title="Patch types">Patch Types</a>. This includes types exclusive to one-, two-, and three-dimensional problems. The patch type number (<span class="tt">#</span>) corresponds to the input value in <span class="tt">input.py</span> labeled <span class="tt">patch_icpp(j)%geometry</span> where $j$ is the patch index. Each patch requires a different set of parameters, which are also listed in this table.</p>
<h3 class="doxsection"><a class="anchor" id="immersed-boundary-patch-types"></a>
Immersed Boundary Patch Types</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">#  </th><th class="markdownTableHeadCenter">Name  </th><th class="markdownTableHeadLeft">Dim.  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">2  </td><td class="markdownTableBodyCenter">2D Circle  </td><td class="markdownTableBodyLeft">2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">3  </td><td class="markdownTableBodyCenter">2D Rectangle  </td><td class="markdownTableBodyLeft">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">4  </td><td class="markdownTableBodyCenter">2D Airfoil  </td><td class="markdownTableBodyLeft">2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">8  </td><td class="markdownTableBodyCenter">3D Sphere  </td><td class="markdownTableBodyLeft">3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">10  </td><td class="markdownTableBodyCenter">3D Cylinder  </td><td class="markdownTableBodyLeft">3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">11  </td><td class="markdownTableBodyCenter">3D Airfoil  </td><td class="markdownTableBodyLeft">3  </td></tr>
</table>
<h3 class="doxsection"><a class="anchor" id="acoustic-supports"></a>
Acoustic Supports</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">#  </th><th class="markdownTableHeadCenter">Name  </th><th class="markdownTableHeadCenter">Dim.  </th><th class="markdownTableHeadLeft">Requirements  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">1  </td><td class="markdownTableBodyCenter">Planar source  </td><td class="markdownTableBodyCenter">1D  </td><td class="markdownTableBodyLeft"><span class="tt">%loc(1)</span>, <span class="tt">%pulse</span>, <span class="tt">%npulse</span>, <span class="tt">%mag</span>, and <span class="tt">%dir</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">2  </td><td class="markdownTableBodyCenter">Planar source  </td><td class="markdownTableBodyCenter">2D  </td><td class="markdownTableBodyLeft">#1 requirements, <span class="tt">%loc(2)</span> and <span class="tt">%length</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">3  </td><td class="markdownTableBodyCenter">Planar source  </td><td class="markdownTableBodyCenter">3D  </td><td class="markdownTableBodyLeft">#2 requirements and <span class="tt">%height</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">5  </td><td class="markdownTableBodyCenter">Cylindrical Transducer  </td><td class="markdownTableBodyCenter">2D  </td><td class="markdownTableBodyLeft"><span class="tt">%loc(1)</span>, <span class="tt">%loc(2)</span>, <span class="tt">%pulse</span>, <span class="tt">%npulse</span>, <span class="tt">%mag</span>, <span class="tt">%foc_length</span>, <span class="tt">%aperture</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">6  </td><td class="markdownTableBodyCenter">Spherical Transducer  </td><td class="markdownTableBodyCenter">2D-Axisym  </td><td class="markdownTableBodyLeft">#5 requirements  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">7  </td><td class="markdownTableBodyCenter">Spherical Transducer  </td><td class="markdownTableBodyCenter">3D  </td><td class="markdownTableBodyLeft">#5 requirements and <span class="tt">%loc(3)</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">9  </td><td class="markdownTableBodyCenter">Arcuate Transducer Array  </td><td class="markdownTableBodyCenter">2D  </td><td class="markdownTableBodyLeft">#5 requirements, <span class="tt">%num_elements</span>, <span class="tt">%element_on</span>, <span class="tt">%element_spacing_angle</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">10  </td><td class="markdownTableBodyCenter">Annular Transducer Array  </td><td class="markdownTableBodyCenter">2D-Axisym  </td><td class="markdownTableBodyLeft">#9 requirements  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">11  </td><td class="markdownTableBodyCenter">Circular Transducer Array  </td><td class="markdownTableBodyCenter">3D  </td><td class="markdownTableBodyLeft">#7 requirements, <span class="tt">%element_polygon_ratio</span>, and <span class="tt">%rotate_angle</span>  </td></tr>
</table>
<p>The required parameters for each acoustic support type are listed in <a class="el" href="#sec-acoustic-source" title="8. Acoustic Source">Acoustic Source</a>. The acoustic support number (<span class="tt">#</span>) corresponds to the acoustic support type <span class="tt">Acoustic(i)%support</span>, where $i$ is the acoustic source index. For each <span class="tt">%parameter</span>, prepend the parameter with <span class="tt">acoustic(i)%</span>.</p>
<p>Additional requirements for all acoustic support types:</p><ul>
<li><span class="tt">acoustic_source = 'T'</span> must be used to activate the acoustic source module.</li>
<li><span class="tt">num_source</span> must be set to the total number of acoustic sources.</li>
<li><span class="tt">%support</span> must be set to the acoustic support number in the table.</li>
<li><span class="tt">%dipole</span> is only supported for planar sources.</li>
<li><span class="tt">%npulse = 1 or 3</span> requires exactly one of <span class="tt">%frequency</span> or <span class="tt">%wavelength</span> to be set. It accepts <span class="tt">%delay</span> as an optional parameter (default = 0).</li>
<li><span class="tt">%npulse = 2</span> requires exactly one of <span class="tt">%gauss_sigma_time</span> or <span class="tt">%gauss_sigma_space</span> to be set. It requires <span class="tt">%delay</span> to be set.</li>
</ul>
<p>Description of the acoustic support types:</p><ul>
<li><span class="tt">%support = 1</span> specifies an infinite source plane that is normal to the $x$-axis and intersects with the axis at $x=$ <span class="tt">%loc(1)</span> in 1D simulation. <span class="tt">%dir &gt; 0</span> specifies a rightward propagating wave, and <span class="tt">%dir &lt; 0</span> specifies a leftward propagating wave. <span class="tt">%dir = 0</span> is not allowed.</li>
<li><span class="tt">%support = 2</span> specifies a semi-infinite source plane in 2D simulation. The midplane location is [<span class="tt">%loc(1)</span>, <span class="tt">%loc(2)</span>] and the normal vector is [ \(\mathrm{cos}\)(<span class="tt">%dir</span>), \(\mathrm{sin}\)(<span class="tt">%dir</span>)]. The length of the source plane is <span class="tt">%length</span>, and the plane is perpendicular to the direction of wave propagation (defined by <span class="tt">%dir</span>).</li>
<li><span class="tt">%support = 3</span> specifies a semi-infinite source plane in 3D simulation. The midplane location is [<span class="tt">%loc(1)</span>, <span class="tt">%loc(2)</span>] and the normal vector is [ \(\mathrm{cos}\)(<span class="tt">%dir</span>), \(\mathrm{sin}\)(<span class="tt">%dir</span>)]. The length of the source plane is <span class="tt">%length</span>, and the plane is perpendicular to the direction of wave propagation (defined by <span class="tt">%dir</span>). Note that the plane is infinite in the $z$-direction, so <span class="tt">%loc(3)</span> is not required.</li>
<li><span class="tt">%support = 5</span> specifies a circular transducer in 2D simulation. The transducer is centered at [<span class="tt">%loc(1)</span>, <span class="tt">%loc(2)</span>] with a focal length of <span class="tt">%foc_length</span> and an aperture of <span class="tt">%aperture</span>. The center location is not the focal point; it is the tip of the circular arc (intersection of the arc and the x-axis). The aperture is the length of the projection of the circular arc onto the y-axis. If a semi-circle is desired, set the aperture to double the focal length. Note that this is physically a cylindrical transducer, and due to the complexity of Green's function for 2D wave, no closed-form solution is available for the 2D circular transducer, and an approximate is used (see Maeda and Colonius <a class="el" href="citelist.html#CITEREF_maeda17">[29]</a> for details). For the mass source term correction factor, the theoretical approximation factor of -0.5 in ($r_{foc}^{-0.5}$) is replaced by an empirically determined factor of -0.85.</li>
<li><span class="tt">%support = 6</span> specifies a spherical transducer in 2D axisymmetric simulation. It is identical to <span class="tt">%support = 5</span> in terms of simulation parameters. Note that this is physically a spherical 3D transducer, so the equation is exact.</li>
<li><span class="tt">%support = 7</span> specifies a spherical transducer in 3D simulation. The transducer is centered at [<span class="tt">%loc(1)</span>, <span class="tt">%loc(2)</span>, <span class="tt">%loc(3)</span>] with a focal length of <span class="tt">%foc_length</span> and an aperture of <span class="tt">%aperture</span>. The center location is not the focal point; it is the tip of the spherical cap (intersection of the cap and the x-axis). The aperture is the diameter of the projection of the spherical cap onto the y-z plane. If a semi-sphere is desired, set the aperture to double the focal length. Again, the equation is exact.</li>
<li><span class="tt">%support = 9</span> specifies an arcuate transducer array in 2D simulation. The total aperture of the array is <span class="tt">%aperture</span>, which is similar to <span class="tt">%support = 5</span>. The parameters <span class="tt">%num_elements</span> and <span class="tt">%element_spacing_angle</span> specify the number of transducer elements and the spacing angle. The spacing angle is the angle of the gap between adjacent transducer elements in the array. Because the total aperture is set, each transducer element is smaller if the spacing angle is larger. Physically it represents curved panels. Note that similar to <span class="tt">%support = 5</span>, the mass source term correction factor is empirically determined to be -0.85.</li>
<li><span class="tt">%support = 10</span> specifies an annular transducer array in 2D axisymmetric simulation. It is identical to <span class="tt">%support = 9</span> in terms of simulation parameters. It physically represents the a annulus obtained by revolving the arc in <span class="tt">%support = 9</span> around the x-axis.</li>
<li><span class="tt">%support = 11</span> specifies a circular transducer array in 3D simulation. The total aperture of the array is <span class="tt">%aperture</span>, which is similar to <span class="tt">%support = 7</span>. The parameters <span class="tt">%num_elements</span>, <span class="tt">%element_polygon_ratio</span>, and <span class="tt">%rotate_angle</span> specify the number of transducer elements, the ratio of the polygon side length to the transducer element radius, and the rotation angle of the array. The polygon side length is calculated by using the total aperture as the circumcicle diameter, and the number of sides of the polygon as <span class="tt">%num_elements</span>. The ratio is used specify the aperture size of each transducer element in the array, as a ratio of the total aperture. The rotation angle is optional and defaults to 0. Physically it represents a circular ring of transducer elements.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md22"></a>
Conservative Variables Ordering</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">5-eqn  </th><th class="markdownTableHeadNone">6-eqn  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">num_fluids continuity variables  </td><td class="markdownTableBodyNone">num_fluids continuity variables  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">num_dims momentum variables  </td><td class="markdownTableBodyNone">num_dims momentum variables  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1 energy variable  </td><td class="markdownTableBodyNone">1 energy variable  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">num_fluids advection variables  </td><td class="markdownTableBodyNone">num_fluids advection variables  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">N/A  </td><td class="markdownTableBodyNone">num_fluids internal energy variables  </td></tr>
</table>
<p>The above variables are used for all simulations.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">5-eqn  </th><th class="markdownTableHeadNone">6-eqn  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">sub-grid bubble variables  </td><td class="markdownTableBodyNone">N/A  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">hypoelastic variables  </td><td class="markdownTableBodyNone">N/A  </td></tr>
</table>
<p>The above variables correspond to optional physics.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md23"></a>
Primitive Variables Ordering</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">5-eqn  </th><th class="markdownTableHeadNone">6-eqn  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">num_fluids densities  </td><td class="markdownTableBodyNone">num_fluids densities  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">num_dims velocities  </td><td class="markdownTableBodyNone">num_dims velocities  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1 pressure  </td><td class="markdownTableBodyNone">1 pressure  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">num_fluids volume fractions  </td><td class="markdownTableBodyNone">num_fluids volume fractions  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">N/A  </td><td class="markdownTableBodyNone">num_fluids partial pressures  </td></tr>
</table>
<p>The above variables are used for all simulations.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">5-eqn  </th><th class="markdownTableHeadNone">6-eqn  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">sub-grid bubble variables  </td><td class="markdownTableBodyNone">N/A  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">hypoelastic variables  </td><td class="markdownTableBodyNone">N/A  </td></tr>
</table>
<p>The above variables correspond to optional physics. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
