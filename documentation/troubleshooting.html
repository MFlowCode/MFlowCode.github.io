<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SY496B9L99"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-SY496B9L99');
</script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC: Troubleshooting Guide</title>
<meta name=”keywords” content="exascale, fluid dynamics, cfd, computational fluid dynamics, compressible, hpc, bryngelson, colonius, subgrid, multiphase, frontier, summit, el capitan, aurora, amd gpu, gpu, nvidia"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
// This file is set as MATHJAX_CODEFILE in the Doxyfile. It configures how
// MathJax renders expressions in Markdown so that it is consistent with GitHub.
MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath:  [ ['$',  '$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true,
      ignoreClass: "line" // Ignore code blocks: https://web.archive.org/web/20120430100225/http://www.mathjax.org/docs/1.1/options/tex2jax.html
    },
    "HTML-CSS": {
      fonts: ["TeX"]
    }
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="icon.ico" type="image/x-icon" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC
   </div>
   <div id="projectbrief">High-fidelity multiphase flow simulation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('troubleshooting.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Troubleshooting Guide </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="autotoc_md369"></a>
Troubleshooting Guide</h1>
<p>This guide covers debugging tools, common issues, and troubleshooting workflows for MFC.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md370"></a>
Quick Reference</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md371"></a>
Debugging Flags</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag  </th><th class="markdownTableHeadNone">Command  </th><th class="markdownTableHeadNone">Purpose  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">-v</span>  </td><td class="markdownTableBodyNone">build, run, test  </td><td class="markdownTableBodyNone">Show commands being executed  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">-vv</span>  </td><td class="markdownTableBodyNone">build, run, test  </td><td class="markdownTableBodyNone">Full compiler/cmake output  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">-vvv</span>  </td><td class="markdownTableBodyNone">build  </td><td class="markdownTableBodyNone">Add cmake dependency debugging  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">-d</span>  </td><td class="markdownTableBodyNone">all  </td><td class="markdownTableBodyNone">Write debug log to file  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">--debug</span>  </td><td class="markdownTableBodyNone">build  </td><td class="markdownTableBodyNone">Build with debug symbols  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">--gcov</span>  </td><td class="markdownTableBodyNone">build  </td><td class="markdownTableBodyNone">Build with code coverage  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">--no-gpu</span>  </td><td class="markdownTableBodyNone">build  </td><td class="markdownTableBodyNone">Disable GPU to isolate issues  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">--no-mpi</span>  </td><td class="markdownTableBodyNone">build  </td><td class="markdownTableBodyNone">Disable MPI to isolate issues  </td></tr>
</table>
<h3 class="doxsection"><a class="anchor" id="autotoc_md372"></a>
Profiling Flags</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag  </th><th class="markdownTableHeadNone">Command  </th><th class="markdownTableHeadNone">Purpose  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">--ncu</span>  </td><td class="markdownTableBodyNone">run  </td><td class="markdownTableBodyNone">NVIDIA Nsight Compute (kernel profiling)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">--nsys</span>  </td><td class="markdownTableBodyNone">run  </td><td class="markdownTableBodyNone">NVIDIA Nsight Systems (timeline profiling)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">--rcu</span>  </td><td class="markdownTableBodyNone">run  </td><td class="markdownTableBodyNone">AMD rocprof-compute  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">--rsys</span>  </td><td class="markdownTableBodyNone">run  </td><td class="markdownTableBodyNone">AMD rocprof  </td></tr>
</table>
<h3 class="doxsection"><a class="anchor" id="autotoc_md373"></a>
Useful Commands</h3>
<div class="fragment"><div class="line">./mfc.sh validate case.py      # Check case for errors before running</div>
<div class="line">./mfc.sh build --debug         # Build with debug symbols</div>
<div class="line">./mfc.sh build -vv             # Build with full compiler output</div>
<div class="line">./mfc.sh run case.py -v        # Run with verbose output</div>
<div class="line">./mfc.sh test --only &lt;UUID&gt;    # Run a specific test</div>
<div class="line">./mfc.sh clean                 # Clean and start fresh</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md375"></a>
Debugging Workflow</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md376"></a>
Build Fails?</h3>
<div class="fragment"><div class="line">1. Run with -vv to see full error output</div>
<div class="line">   ./mfc.sh build -vv</div>
<div class="line"> </div>
<div class="line">2. If dependency issue, try -vvv for cmake debug</div>
<div class="line">   ./mfc.sh build -vvv</div>
<div class="line"> </div>
<div class="line">3. Try disabling features to isolate:</div>
<div class="line">   ./mfc.sh build --no-gpu      # Rule out GPU issues</div>
<div class="line">   ./mfc.sh build --no-mpi      # Rule out MPI issues</div>
<div class="line"> </div>
<div class="line">4. Clean and rebuild:</div>
<div class="line">   ./mfc.sh clean &amp;&amp; ./mfc.sh build</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md377"></a>
Run Fails?</h3>
<div class="fragment"><div class="line">1. Validate your case first:</div>
<div class="line">   ./mfc.sh validate case.py</div>
<div class="line"> </div>
<div class="line">2. Run with verbose output:</div>
<div class="line">   ./mfc.sh run case.py -v</div>
<div class="line"> </div>
<div class="line">3. Check for NaN or constraint errors in output</div>
<div class="line"> </div>
<div class="line">4. Try with fewer MPI ranks:</div>
<div class="line">   ./mfc.sh run case.py -n 1</div>
<div class="line"> </div>
<div class="line">5. Build in debug mode for better error messages:</div>
<div class="line">   ./mfc.sh build --debug</div>
<div class="line">   ./mfc.sh run case.py</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md378"></a>
Test Fails?</h3>
<div class="fragment"><div class="line">1. Run the specific failing test:</div>
<div class="line">   ./mfc.sh test --only &lt;UUID&gt;</div>
<div class="line"> </div>
<div class="line">2. Run serially for clearer output:</div>
<div class="line">   ./mfc.sh test --only &lt;UUID&gt; -j 1</div>
<div class="line"> </div>
<div class="line">3. Check test output in:</div>
<div class="line">   build/tests/&lt;UUID&gt;/</div>
<div class="line"> </div>
<div class="line">4. If changes are intentional, regenerate golden files:</div>
<div class="line">   ./mfc.sh test --generate --only &lt;UUID&gt;</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md380"></a>
Build Debugging</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md381"></a>
Verbosity Levels</h3>
<p>MFC supports three verbosity levels for builds:</p>
<p><b><span class="tt">-v</span> (Level 1):</b> Shows build progress with file counts </p><div class="fragment"><div class="line">./mfc.sh build -v</div>
<div class="line"># Shows: [1/42] Compiling m_global_parameters.fpp.f90</div>
</div><!-- fragment --><p><b><span class="tt">-vv</span> (Level 2):</b> Full compiler commands and cmake output </p><div class="fragment"><div class="line">./mfc.sh build -vv</div>
<div class="line"># Shows: Full compiler invocations with all flags</div>
<div class="line"># Useful for: Seeing exact compiler errors, checking flags</div>
</div><!-- fragment --><p><b><span class="tt">-vvv</span> (Level 3):</b> Adds cmake dependency debugging </p><div class="fragment"><div class="line">./mfc.sh build -vvv</div>
<div class="line"># Shows: cmake --debug-find output</div>
<div class="line"># Useful for: Finding why cmake can&#39;t locate MPI, HDF5, etc.</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md382"></a>
Debug Builds</h3>
<p>Build with debug symbols for better error messages and debugging:</p>
<div class="fragment"><div class="line">./mfc.sh build --debug</div>
</div><!-- fragment --><p>This sets <span class="tt">CMAKE_BUILD_TYPE=Debug</span>, which:</p><ul>
<li>Adds <span class="tt">-g</span> debug symbols</li>
<li>Reduces optimization (<span class="tt">-O0</span> or <span class="tt">-O1</span>)</li>
<li>Enables runtime checks in some compilers</li>
<li>Makes stack traces more readable</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md383"></a>
Code Coverage</h3>
<p>Build with code coverage instrumentation:</p>
<div class="fragment"><div class="line">./mfc.sh build --gcov</div>
</div><!-- fragment --><p>Useful for identifying which code paths are exercised by tests.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md384"></a>
Isolating Issues</h3>
<p>When builds fail, isolate the problem by disabling features:</p>
<div class="fragment"><div class="line"># Rule out GPU compiler issues</div>
<div class="line">./mfc.sh build --no-gpu</div>
<div class="line"> </div>
<div class="line"># Rule out MPI issues</div>
<div class="line">./mfc.sh build --no-mpi</div>
<div class="line"> </div>
<div class="line"># Rule out precision issues</div>
<div class="line">./mfc.sh build --single    # Single precision</div>
<div class="line">./mfc.sh build --mixed     # Mixed precision</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md385"></a>
Clean Rebuild</h3>
<p>Sometimes a clean rebuild fixes issues:</p>
<div class="fragment"><div class="line">./mfc.sh clean</div>
<div class="line">./mfc.sh build -j $(nproc)</div>
</div><!-- fragment --><p>Or manually: </p><div class="fragment"><div class="line">rm -rf build/</div>
<div class="line">./mfc.sh build -j $(nproc)</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md387"></a>
Runtime Debugging</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md388"></a>
Case Validation</h3>
<p><b>Always validate your case before running:</b></p>
<div class="fragment"><div class="line">./mfc.sh validate case.py</div>
</div><!-- fragment --><p>This checks for:</p><ul>
<li>Syntax errors in case.py</li>
<li>Invalid parameter values</li>
<li>Constraint violations (incompatible parameter combinations)</li>
<li>Typos in parameter names (with "did you mean?" suggestions)</li>
</ul>
<p><b>Example output:</b> </p><div class="fragment"><div class="line">Errors:</div>
<div class="line">  [red] weno_order=7 but must be one of: [1, 3, 5]</div>
<div class="line">  [red] Unknown parameter &#39;weno_ordr&#39; - did you mean &#39;weno_order&#39;?</div>
<div class="line"> </div>
<div class="line">Warnings:</div>
<div class="line">  [yellow] bubbles=True recommends setting: nb, polytropic</div>
</div><!-- fragment --><p>For more detailed validation output: </p><div class="fragment"><div class="line">./mfc.sh validate case.py -d</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md389"></a>
Verbose Runs</h3>
<p>Add verbosity to see what's happening:</p>
<div class="fragment"><div class="line"># Show the exact command being run</div>
<div class="line">./mfc.sh run case.py -v</div>
<div class="line"> </div>
<div class="line"># Show job script details</div>
<div class="line">./mfc.sh run case.py -vv</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md390"></a>
Debug Log</h3>
<p>Write detailed debug information to a log file:</p>
<div class="fragment"><div class="line">./mfc.sh run case.py -d</div>
</div><!-- fragment --><p>This creates a debug log with detailed internal state, useful for reporting issues.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md391"></a>
Running with Fewer Ranks</h3>
<p>To isolate parallel issues, try running with fewer MPI ranks:</p>
<div class="fragment"><div class="line">./mfc.sh run case.py -n 1    # Single rank</div>
<div class="line">./mfc.sh run case.py -n 2    # Two ranks</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md393"></a>
Test Debugging</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md394"></a>
Running Specific Tests</h3>
<p>Run only a specific test by UUID:</p>
<div class="fragment"><div class="line">./mfc.sh test --only 3D_sphbubcollapse</div>
</div><!-- fragment --><p>Run multiple specific tests: </p><div class="fragment"><div class="line">./mfc.sh test --only 3D_sphbubcollapse 2D_shockbubble</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md395"></a>
Serial Test Execution</h3>
<p>Run tests serially for clearer output:</p>
<div class="fragment"><div class="line">./mfc.sh test -j 1</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md396"></a>
Test Output Location</h3>
<p>Test outputs are written to: </p><div class="fragment"><div class="line">build/tests/&lt;UUID&gt;/</div>
</div><!-- fragment --><p>This directory contains:</p><ul>
<li>Input files generated from case.py</li>
<li>Output files from each stage (pre_process, simulation, post_process)</li>
<li>Any error messages or logs</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md397"></a>
Regenerating Golden Files</h3>
<p>If you intentionally changed physics/numerics, regenerate reference files:</p>
<div class="fragment"><div class="line"># Regenerate for specific tests</div>
<div class="line">./mfc.sh test --generate --only &lt;UUID&gt;</div>
<div class="line"> </div>
<div class="line"># Regenerate for a range of tests</div>
<div class="line">./mfc.sh test --generate --from &lt;UUID1&gt; --to &lt;UUID2&gt;</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md398"></a>
Understanding Test Failures</h3>
<p><b>"Golden file mismatch"</b> means numerical results differ from reference values.</p>
<p>Possible causes:</p><ol type="1">
<li><b>Intentional changes:</b> Regenerate golden files with <span class="tt">--generate</span></li>
<li><b>Compiler differences:</b> Different compilers produce slightly different results</li>
<li><b>Precision settings:</b> Single vs double precision</li>
<li><b>Platform differences:</b> CPU architecture, GPU differences</li>
</ol>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md400"></a>
Performance Profiling</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md401"></a>
NVIDIA GPU Profiling</h3>
<p><b>Nsight Compute</b> (kernel-level analysis): </p><div class="fragment"><div class="line">./mfc.sh run case.py --ncu</div>
<div class="line"># Or with additional ncu flags:</div>
<div class="line">./mfc.sh run case.py --ncu --set full</div>
</div><!-- fragment --><p><b>Nsight Systems</b> (timeline/system analysis): </p><div class="fragment"><div class="line">./mfc.sh run case.py --nsys</div>
<div class="line"># Or with additional nsys flags:</div>
<div class="line">./mfc.sh run case.py --nsys -o profile_output</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md402"></a>
AMD GPU Profiling</h3>
<p><b>rocprof-compute</b> (kernel analysis): </p><div class="fragment"><div class="line">./mfc.sh run case.py --rcu</div>
</div><!-- fragment --><p><b>rocprof</b> (system profiling): </p><div class="fragment"><div class="line">./mfc.sh run case.py --rsys</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md403"></a>
Performance vs Correctness</h3>
<p>If results seem wrong, first verify correctness:</p><ol type="1">
<li>Run <span class="tt">./mfc.sh validate case.py</span></li>
<li>Compare against a known working case</li>
<li>Try <span class="tt">--debug</span> build for better error detection</li>
</ol>
<p>If results are correct but slow:</p><ol type="1">
<li>Use profiling tools above to identify bottlenecks</li>
<li>Try <span class="tt">--case-optimization</span> for production runs (10x speedup)</li>
<li>Check GPU utilization with <span class="tt">nvidia-smi</span> or <span class="tt">rocm-smi</span></li>
</ol>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md405"></a>
Common Build Errors</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md406"></a>
"CMake could not find MPI"</h3>
<p><b>Cause:</b> MPI is not installed or not in PATH.</p>
<p><b>Fix:</b></p><ul>
<li><b>Ubuntu/Debian:</b> <span class="tt">sudo apt install libopenmpi-dev openmpi-bin</span></li>
<li><b>macOS (Homebrew):</b> <span class="tt">brew install open-mpi</span></li>
<li><b>HPC systems:</b> <span class="tt">module load openmpi</span> or use <span class="tt">./mfc.sh load</span></li>
</ul>
<p>Verify: <span class="tt">mpirun --version</span></p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md407"></a>
"CMake could not find a Fortran compiler"</h3>
<p><b>Cause:</b> No Fortran compiler installed or not in PATH.</p>
<p><b>Fix:</b></p><ul>
<li><b>Ubuntu/Debian:</b> <span class="tt">sudo apt install gfortran</span></li>
<li><b>macOS (Homebrew):</b> <span class="tt">brew install gcc</span></li>
<li><b>HPC systems:</b> <span class="tt">module load gcc</span> or <span class="tt">module load nvhpc</span></li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md408"></a>
"Fypp preprocessing failed"</h3>
<p><b>Cause:</b> Syntax error in <span class="tt">.fpp</span> files or missing Fypp.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Ensure Fypp is installed: <span class="tt">pip install fypp</span></li>
<li>Check the specific error line in the output</li>
<li>Run <span class="tt">./mfc.sh format</span> to check for formatting issues</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md409"></a>
Build fails with GPU/OpenACC errors</h3>
<p><b>Cause:</b> GPU compiler not properly configured.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Verify GPU compiler is available:<ul>
<li>NVIDIA: <span class="tt">nvfortran --version</span></li>
<li>AMD: <span class="tt">ftn --version</span> or <span class="tt">amdflang --version</span></li>
</ul>
</li>
<li>Load appropriate modules: <span class="tt">module load nvhpc</span> or <span class="tt">module load rocm</span></li>
<li>Set CUDA compute capability if needed: <span class="tt">export MFC_CUDA_CC=80</span></li>
<li>Try building without GPU first: <span class="tt">./mfc.sh build --no-gpu</span></li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md410"></a>
"Module not found" on HPC</h3>
<p><b>Cause:</b> Required modules not loaded.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Use MFC's module loader if available for your system: <div class="fragment"><div class="line">source ./mfc.sh load -c &lt;cluster&gt; -m &lt;mode&gt;</div>
</div><!-- fragment --></li>
<li>Or manually load modules: <div class="fragment"><div class="line">module load gcc openmpi cmake python</div>
</div><!-- fragment --></li>
</ol>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md412"></a>
Common Runtime Errors</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md413"></a>
"Case parameter constraint violations"</h3>
<p><b>Cause:</b> Invalid combination of simulation parameters.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Run <span class="tt">./mfc.sh validate case.py</span> for detailed diagnostics</li>
<li>Check the specific constraint mentioned</li>
<li>Review similar examples in <span class="tt">examples/</span></li>
</ol>
<p>Common issues:</p><ul>
<li>Grid dimensions (<span class="tt">m</span>, <span class="tt">n</span>, <span class="tt">p</span>) not matching dimensionality</li>
<li><span class="tt">weno_order</span> too high for grid size</li>
<li>Boundary conditions not matching domain setup</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md414"></a>
"NaN detected"</h3>
<p><b>Cause:</b> Numerical instability.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Reduce time step (<span class="tt">dt</span>)</li>
<li>Check initial conditions for unphysical values</li>
<li>Verify boundary conditions are appropriate</li>
<li>Try a more diffusive scheme initially</li>
<li>Check CFL condition</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md415"></a>
GPU not detected</h3>
<p><b>Cause:</b> GPU drivers or runtime not configured.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Verify GPU is visible:<ul>
<li>NVIDIA: <span class="tt">nvidia-smi</span></li>
<li>AMD: <span class="tt">rocm-smi</span></li>
</ul>
</li>
<li>Check compiler supports GPU offloading</li>
<li>Ensure correct modules are loaded</li>
<li>Set <span class="tt">OMP_TARGET_OFFLOAD=MANDATORY</span> to force GPU (fails fast if unavailable)</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md416"></a>
MPI errors or hangs</h3>
<p><b>Cause:</b> MPI configuration issues or deadlocks.</p>
<p><b>Fix:</b></p><ol type="1">
<li>Verify MPI works: <span class="tt">mpirun -n 2 hostname</span></li>
<li>Try with fewer ranks: <span class="tt">./mfc.sh run case.py -n 1</span></li>
<li>Check for incompatible MPI/compiler combinations</li>
<li>On clusters, ensure you're using the correct MPI for the interconnect</li>
</ol>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md418"></a>
Getting Help</h2>
<p>If you can't resolve an issue:</p>
<ol type="1">
<li><b>Search existing issues:</b> <a href="https://github.com/MFlowCode/MFC/issues">GitHub Issues</a></li>
<li><b>Check documentation:</b> <a href="https://mflowcode.github.io/">MFC Documentation</a></li>
<li><b>Open a new issue</b> with:<ul>
<li>Your OS and compiler versions</li>
<li>The exact command you ran</li>
<li>Complete error output (use <span class="tt">-vv</span> for builds)</li>
<li>Your case file (if applicable)</li>
<li>Output of <span class="tt">./mfc.sh validate case.py</span></li>
</ul>
</li>
<li><b>Use the CLI help:</b> <div class="fragment"><div class="line">./mfc.sh help debugging</div>
<div class="line">./mfc.sh help gpu</div>
<div class="line">./mfc.sh &lt;command&gt; -h</div>
</div><!-- fragment --> </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
